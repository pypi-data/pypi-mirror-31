/*! selectize.js - v0.12.4 | https://github.com/selectize/selectize.js | Apache License (v2) */
;!function(d,c){"function"==typeof define&&define.amd?define("sifter",c):"object"==typeof exports?module.exports=c():d.Sifter=c()}(this,function(){var r=function(d,c){this.items=d,this.settings=c||{diacritics:!0}};r.prototype.tokenize=function(f){if(f=n(String(f||"").toLowerCase()),!f||!f.length){return[]}var e,v,u,t,s=[],h=f.split(/ +/);for(e=0,v=h.length;e<v;e++){if(u=m(h[e]),this.settings.diacritics){for(t in k){k.hasOwnProperty(t)&&(u=u.replace(new RegExp(t,"g"),k[t]))}}s.push({string:h[e],regex:new RegExp(u,"i")})}return s},r.prototype.iterator=function(e,d){var f;f=l(e)?Array.prototype.forEach||function(h){for(var g=0,i=this.length;g<i;g++){h(this[g],g,this)}}:function(g){for(var c in this){this.hasOwnProperty(c)&&g(this[c],c,this)}},f.apply(e,[d])},r.prototype.getScoreFunction=function(z,y){var x,w,v,u,t;x=this,z=x.prepareSearch(z,y),v=z.tokens,w=z.options.fields,u=v.length,t=z.options.nesting;var s=function(f,e){var h,g;return f?(f=String(f||""),g=f.search(e.regex),g===-1?0:(h=e.string.length/f.length,0===g&&(h+=0.5),h)):0},d=function(){var b=w.length;return b?1===b?function(e,c){return s(o(c,w[0],t),e)}:function(a,i){for(var h=0,e=0;h<b;h++){e+=s(o(i,w[h],t),a)}return e/b}:function(){return 0}}();return u?1===u?function(b){return d(v[0],b)}:"and"===z.options.conjunction?function(f){for(var e,h=0,g=0;h<u;h++){if(e=d(v[h],f),e<=0){return 0}g+=e}return g/u}:function(f){for(var e=0,g=0;e<u;e++){g+=d(v[e],f)}return g/u}:function(){return 0}},r.prototype.getSortFunction=function(C,B){var A,z,y,x,w,v,u,t,s,d,b;if(y=this,C=y.prepareSearch(C,B),b=!C.query&&B.sort_empty||B.sort,s=function(e,c){return"$score"===e?c.score:o(y.items[c.id],e,B.nesting)},w=[],b){for(A=0,z=b.length;A<z;A++){(C.query||"$score"!==b[A].field)&&w.push(b[A])}}if(C.query){for(d=!0,A=0,z=w.length;A<z;A++){if("$score"===w[A].field){d=!1;break}}d&&w.unshift({field:"$score",direction:"desc"})}else{for(A=0,z=w.length;A<z;A++){if("$score"===w[A].field){w.splice(A,1);break}}}for(t=[],A=0,z=w.length;A<z;A++){t.push("desc"===w[A].direction?-1:1)}return v=w.length,v?1===v?(x=w[0].field,u=t[0],function(e,f){return u*q(s(x,e),s(x,f))}):function(g,E){var D,i,h;for(D=0;D<v;D++){if(h=w[D].field,i=t[D]*q(s(h,g),s(h,E))){return i}}return 0}:null},r.prototype.prepareSearch=function(g,c){if("object"==typeof g){return g}c=p({},c);var s=c.fields,i=c.sort,h=c.sort_empty;return s&&!l(s)&&(c.fields=[s]),i&&!l(i)&&(c.sort=[i]),h&&!l(h)&&(c.sort_empty=[h]),{options:c,query:String(g||"").toLowerCase(),tokens:this.tokenize(g),total:0,items:[]}},r.prototype.search=function(i,h){var w,v,u,t,s=this;return v=this.prepareSearch(i,h),h=v.options,i=v.query,t=h.score||s.getScoreFunction(v),i.length?s.iterator(s.items,function(b,c){w=t(b),(h.filter===!1||w>0)&&v.items.push({score:w,id:c})}):s.iterator(s.items,function(d,c){v.items.push({score:1,id:c})}),u=s.getSortFunction(v,h),u&&v.items.sort(u),v.total=v.items.length,"number"==typeof h.limit&&(v.items=v.items.slice(0,h.limit)),v};var q=function(d,c){return"number"==typeof d&&"number"==typeof c?d>c?1:d<c?-1:0:(d=j(String(d||"")),c=j(String(c||"")),d>c?1:c>d?-1:0)},p=function(h,g){var u,t,s,i;for(u=1,t=arguments.length;u<t;u++){if(i=arguments[u]){for(s in i){i.hasOwnProperty(s)&&(h[s]=i[s])}}}return h},o=function(f,e,h){if(f&&e){if(!h){return f[e]}for(var g=e.split(".");g.length&&(f=f[g.shift()]);){}return f}},n=function(b){return(b+"").replace(/^\s+|\s+$|/g,"")},m=function(b){return(b+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},l=Array.isArray||"undefined"!=typeof $&&$.isArray||function(b){return"[object Array]"===Object.prototype.toString.call(b)},k={a:"[aá¸€á¸Ä‚ÄƒÃ‚Ã¢ÇÇŽÈºâ±¥È¦È§áº áº¡Ã„Ã¤Ã€Ã ÃÃ¡Ä€ÄÃƒÃ£Ã…Ã¥Ä…Ä„ÃƒÄ…Ä„]",b:"[bâ¢Î²Î’Bà¸¿ðŒá›’]",c:"[cÄ†Ä‡ÄˆÄ‰ÄŒÄÄŠÄ‹CÌ„cÌ„Ã‡Ã§á¸ˆá¸‰È»È¼Æ‡ÆˆÉ•á´„ï¼£ï½ƒ]",d:"[dÄŽÄá¸Šá¸‹á¸á¸‘á¸Œá¸á¸’á¸“á¸Žá¸ÄÄ‘DÌ¦dÌ¦Æ‰É–ÆŠÉ—Æ‹ÆŒáµ­á¶á¶‘È¡á´…ï¼¤ï½„Ã°]",e:"[eÃ‰Ã©ÃˆÃ¨ÃŠÃªá¸˜á¸™ÄšÄ›Ä”Ä•áº¼áº½á¸šá¸›áººáº»Ä–Ä—Ã‹Ã«Ä’Ä“È¨È©Ä˜Ä™á¶’É†É‡È„È…áº¾áº¿á»€á»á»„á»…á»‚á»ƒá¸œá¸á¸–á¸—á¸”á¸•È†È‡áº¸áº¹á»†á»‡â±¸á´‡ï¼¥ï½…É˜ÇÆÆÎµ]",f:"[fÆ‘Æ’á¸žá¸Ÿ]",g:"[gÉ¢â‚²Ç¤Ç¥ÄœÄÄžÄŸÄ¢Ä£Æ“É Ä Ä¡]",h:"[hÄ¤Ä¥Ä¦Ä§á¸¨á¸©áº–áº–á¸¤á¸¥á¸¢á¸£É¦Ê°Ç¶Æ•]",i:"[iÃÃ­ÃŒÃ¬Ä¬Ä­ÃŽÃ®ÇÇÃÃ¯á¸®á¸¯Ä¨Ä©Ä®Ä¯ÄªÄ«á»ˆá»‰ÈˆÈ‰ÈŠÈ‹á»Šá»‹á¸¬á¸­Æ—É¨É¨Ì†áµ»á¶–Ä°iIÄ±Éªï¼©ï½‰]",j:"[jÈ·Ä´ÄµÉˆÉ‰ÊÉŸÊ²]",k:"[kÆ˜Æ™ê€êá¸°á¸±Ç¨Ç©á¸²á¸³á¸´á¸µÎºÏ°â‚­]",l:"[lÅÅ‚Ä½Ä¾Ä»Ä¼Ä¹Äºá¸¶á¸·á¸¸á¸¹á¸¼á¸½á¸ºá¸»Ä¿Å€È½Æšâ± â±¡â±¢É«É¬á¶…É­È´ÊŸï¼¬ï½Œ]",n:"[nÅƒÅ„Ç¸Ç¹Å‡ÅˆÃ‘Ã±á¹„á¹…Å…Å†á¹†á¹‡á¹Šá¹‹á¹ˆá¹‰NÌˆnÌˆÆÉ²È Æžáµ°á¶‡É³ÈµÉ´ï¼®ï½ŽÅŠÅ‹]",o:"[oÃ˜Ã¸Ã–Ã¶Ã“Ã³Ã’Ã²Ã”Ã´Ç‘Ç’ÅÅ‘ÅŽÅÈ®È¯á»Œá»ÆŸÉµÆ Æ¡á»Žá»ÅŒÅÃ•ÃµÇªÇ«ÈŒÈÕ•Ö…]",p:"[pá¹”á¹•á¹–á¹—â±£áµ½Æ¤Æ¥áµ±]",q:"[qê–ê—Ê ÉŠÉ‹ê˜ê™qÌƒ]",r:"[rÅ”Å•ÉŒÉÅ˜Å™Å–Å—á¹˜á¹™ÈÈ‘È’È“á¹šá¹›â±¤É½]",s:"[sÅšÅ›á¹ á¹¡á¹¢á¹£êž¨êž©ÅœÅÅ Å¡ÅžÅŸÈ˜È™SÌˆsÌˆ]",t:"[tÅ¤Å¥á¹ªá¹«Å¢Å£á¹¬á¹­Æ®ÊˆÈšÈ›á¹°á¹±á¹®á¹¯Æ¬Æ­]",u:"[uÅ¬Å­É„Ê‰á»¤á»¥ÃœÃ¼ÃšÃºÃ™Ã¹Ã›Ã»Ç“Ç”Å°Å±Å¬Å­Æ¯Æ°á»¦á»§ÅªÅ«Å¨Å©Å²Å³È”È•âˆª]",v:"[vá¹¼á¹½á¹¾á¹¿Æ²Ê‹êžêŸâ±±Ê‹]",w:"[wáº‚áºƒáº€áºÅ´Åµáº„áº…áº†áº‡áºˆáº‰]",x:"[xáºŒáºáºŠáº‹Ï‡]",y:"[yÃÃ½á»²á»³Å¶Å·Å¸Ã¿á»¸á»¹áºŽáºá»´á»µÉŽÉÆ³Æ´]",z:"[zÅ¹Åºáºáº‘Å½Å¾Å»Å¼áº’áº“áº”áº•ÆµÆ¶]"},j=function(){var i,h,w,v,u="",t={};for(w in k){if(k.hasOwnProperty(w)){for(v=k[w].substring(2,k[w].length-1),u+=v,i=0,h=v.length;i<h;i++){t[v.charAt(i)]=w}}}var s=new RegExp("["+u+"]","g");return function(b){return b.replace(s,function(c){return t[c]}).toLowerCase()}}();return r}),function(d,c){"function"==typeof define&&define.amd?define("microplugin",c):"object"==typeof exports?module.exports=c():d.MicroPlugin=c()}(this,function(){var d={};d.mixin=function(b){b.plugins={},b.prototype.initializePlugins=function(h){var m,l,k,j=this,i=[];if(j.plugins={names:[],settings:{},requested:{},loaded:{}},c.isArray(h)){for(m=0,l=h.length;m<l;m++){"string"==typeof h[m]?i.push(h[m]):(j.plugins.settings[h[m].name]=h[m].options,i.push(h[m].name))}}else{if(h){for(k in h){h.hasOwnProperty(k)&&(j.plugins.settings[k]=h[k],i.push(k))}}}for(;i.length;){j.require(i.shift())}},b.prototype.loadPlugin=function(a){var h=this,g=h.plugins,f=b.plugins[a];if(!b.plugins.hasOwnProperty(a)){throw new Error('Unable to find "'+a+'" plugin')}g.requested[a]=!0,g.loaded[a]=f.fn.apply(h,[h.plugins.settings[a]||{}]),g.names.push(a)},b.prototype.require=function(f){var e=this,g=e.plugins;if(!e.plugins.loaded.hasOwnProperty(f)){if(g.requested[f]){throw new Error('Plugin has circular dependency ("'+f+'")')}e.loadPlugin(f)}return g.loaded[f]},b.define=function(a,e){b.plugins[a]={name:a,fn:e}}};var c={isArray:Array.isArray||function(b){return"[object Array]"===Object.prototype.toString.call(b)}};return d}),function(d,c){"function"==typeof define&&define.amd?define("selectize",["jquery","sifter","microplugin"],c):"object"==typeof exports?module.exports=c(require("jquery"),require("sifter"),require("microplugin")):d.Selectize=c(d.jQuery,d.Sifter,d.MicroPlugin)}(this,function(aA,az,ay){var ax=function(f,e){if("string"!=typeof e||e.length){var h="string"==typeof e?new RegExp(e,"i"):e,g=function(d){var c=0;if(3===d.nodeType){var p=d.data.search(h);if(p>=0&&d.data.length>0){var o=d.data.match(h),n=document.createElement("span");n.className="highlight";var m=d.splitText(p),l=(m.splitText(o[0].length),m.cloneNode(!0));n.appendChild(l),m.parentNode.replaceChild(n,m),c=1}}else{if(1===d.nodeType&&d.childNodes&&!/(script|style)/i.test(d.tagName)){for(var k=0;k<d.childNodes.length;++k){k+=g(d.childNodes[k])}}}return c};return f.each(function(){g(this)})}};aA.fn.removeHighlight=function(){return this.find("span.highlight").each(function(){this.parentNode.firstChild.nodeName;var b=this.parentNode;b.replaceChild(this.firstChild,this),b.normalize()}).end()};var aw=function(){};aw.prototype={on:function(d,c){this._events=this._events||{},this._events[d]=this._events[d]||[],this._events[d].push(c)},off:function(e,d){var f=arguments.length;return 0===f?delete this._events:1===f?delete this._events[e]:(this._events=this._events||{},void (e in this._events!=!1&&this._events[e].splice(this._events[e].indexOf(d),1)))},trigger:function(d){if(this._events=this._events||{},d in this._events!=!1){for(var c=0;c<this._events[d].length;c++){this._events[d][c].apply(this,Array.prototype.slice.call(arguments,1))}}}},aw.mixin=function(e){for(var d=["on","off","trigger"],f=0;f<d.length;f++){e.prototype[d[f]]=aw.prototype[d[f]]}};var av=/Mac/.test(navigator.userAgent),au=65,at=13,ar=27,aq=37,ap=38,ao=80,an=39,am=40,al=78,ak=8,aj=46,ai=16,ah=av?91:17,ag=av?18:17,af=9,ae=1,ad=2,ac=!/android/i.test(window.navigator.userAgent)&&!!document.createElement("input").validity,ab=function(b){return"undefined"!=typeof b},aa=function(b){return"undefined"==typeof b||null===b?null:"boolean"==typeof b?b?"1":"0":b+""},Z=function(b){return(b+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},Y={};Y.before=function(f,e,h){var g=f[e];f[e]=function(){return h.apply(f,arguments),g.apply(f,arguments)}},Y.after=function(f,e,h){var g=f[e];f[e]=function(){var a=g.apply(f,arguments);return h.apply(f,arguments),a}};var X=function(d){var c=!1;return function(){c||(c=!0,d.apply(this,arguments))}},W=function(e,d){var f;return function(){var b=this,a=arguments;window.clearTimeout(f),f=window.setTimeout(function(){e.apply(b,a)},d)}},V=function(h,g,l){var k,j=h.trigger,i={};h.trigger=function(){var a=arguments[0];return g.indexOf(a)===-1?j.apply(h,arguments):void (i[a]=arguments)},l.apply(h,[]),h.trigger=j;for(k in i){i.hasOwnProperty(k)&&j.apply(h,i[k])}},U=function(f,e,h,g){f.on(e,h,function(a){for(var d=a.target;d&&d.parentNode!==f[0];){d=d.parentNode}return a.currentTarget=d,g.apply(this,[a])})},T=function(f){var e={};if("selectionStart" in f){e.start=f.selectionStart,e.length=f.selectionEnd-e.start}else{if(document.selection){f.focus();var h=document.selection.createRange(),g=document.selection.createRange().text.length;h.moveStart("character",-f.value.length),e.start=h.text.length-g,e.length=g}}return e},S=function(h,g,l){var k,j,i={};if(l){for(k=0,j=l.length;k<j;k++){i[l[k]]=h.css(l[k])}}else{i=h.css()}g.css(i)},R=function(a,h){if(!a){return 0}var g=aA("<test>").css({position:"absolute",top:-99999,left:-99999,width:"auto",padding:0,whiteSpace:"pre"}).text(a).appendTo("body");S(h,g,["letterSpacing","fontSize","fontFamily","fontWeight","textTransform"]);var f=g.width();return g.remove(),f},Q=function(e){var d=null,f=function(t,s){var r,q,p,o,n,m,b,a;t=t||window.event||{},s=s||{},t.metaKey||t.altKey||(s.force||e.data("grow")!==!1)&&(r=e.val(),t.type&&"keydown"===t.type.toLowerCase()&&(q=t.keyCode,p=q>=97&&q<=122||q>=65&&q<=90||q>=48&&q<=57||32===q,q===aj||q===ak?(a=T(e[0]),a.length?r=r.substring(0,a.start)+r.substring(a.start+a.length):q===ak&&a.start?r=r.substring(0,a.start-1)+r.substring(a.start+1):q===aj&&"undefined"!=typeof a.start&&(r=r.substring(0,a.start)+r.substring(a.start+1))):p&&(m=t.shiftKey,b=String.fromCharCode(t.keyCode),b=m?b.toUpperCase():b.toLowerCase(),r+=b)),o=e.attr("placeholder"),!r&&o&&(r=o),n=R(r,e)+4,n!==d&&(d=n,e.width(n),e.triggerHandler("resize")))};e.on("keydown keyup update blur",f),f()},P=function(d){var c=document.createElement("div");return c.appendChild(d.cloneNode(!0)),c.innerHTML},O=function(e,d){d||(d={});var f="Selectize";console.error(f+": "+e),d.explanation&&(console.group&&console.group(),console.error(d.explanation),console.group&&console.groupEnd())},N=function(p,o){var n,m,l,k,b=this;k=p[0],k.selectize=b;var a=window.getComputedStyle&&window.getComputedStyle(k,null);if(l=a?a.getPropertyValue("direction"):k.currentStyle&&k.currentStyle.direction,l=l||p.parents("[dir]:first").attr("dir")||"",aA.extend(b,{order:0,settings:o,$input:p,tabIndex:p.attr("tabindex")||"",tagType:"select"===k.tagName.toLowerCase()?ae:ad,rtl:/rtl/i.test(l),eventNS:".selectize"+ ++N.count,highlightedValue:null,isOpen:!1,isDisabled:!1,isRequired:p.is("[required]"),isInvalid:!1,isLocked:!1,isFocused:!1,isInputHidden:!1,isSetup:!1,isShiftDown:!1,isCmdDown:!1,isCtrlDown:!1,ignoreFocus:!1,ignoreBlur:!1,ignoreHover:!1,hasOptions:!1,currentResults:null,lastValue:"",caretPos:0,loading:0,loadedSearches:{},$activeOption:null,$activeItems:[],optgroups:{},options:{},userOptions:{},items:[],renderCache:{},onSearchChange:null===o.loadThrottle?b.onSearchChange:W(b.onSearchChange,o.loadThrottle)}),b.sifter=new az(this.options,{diacritics:o.diacritics}),b.settings.options){for(n=0,m=b.settings.options.length;n<m;n++){b.registerOption(b.settings.options[n])}delete b.settings.options}if(b.settings.optgroups){for(n=0,m=b.settings.optgroups.length;n<m;n++){b.registerOptionGroup(b.settings.optgroups[n])}delete b.settings.optgroups}b.settings.mode=b.settings.mode||(1===b.settings.maxItems?"single":"multi"),"boolean"!=typeof b.settings.hideSelected&&(b.settings.hideSelected="multi"===b.settings.mode),b.initializePlugins(b.settings.plugins),b.setupCallbacks(),b.setupTemplates(),b.setup()};return aw.mixin(N),"undefined"!=typeof ay?ay.mixin(N):O("Dependency MicroPlugin is missing",{explanation:'Make sure you either: (1) are using the "standalone" version of Selectize, or (2) require MicroPlugin before you load Selectize.'}),aA.extend(N.prototype,{setup:function(){var F,E,D,C,B,A,z,y,x,v,t=this,s=t.settings,r=t.eventNS,f=aA(window),a=aA(document),H=t.$input;if(z=t.settings.mode,y=H.attr("class")||"",F=aA("<div>").addClass(s.wrapperClass).addClass(y).addClass(z),E=aA("<div>").addClass(s.inputClass).addClass("items").appendTo(F),D=aA('<input type="text" autocomplete="off" />').appendTo(E).attr("tabindex",H.is(":disabled")?"-1":t.tabIndex),A=aA(s.dropdownParent||F),C=aA("<div>").addClass(s.dropdownClass).addClass(z).hide().appendTo(A),B=aA("<div>").addClass(s.dropdownContentClass).appendTo(C),(v=H.attr("id"))&&(D.attr("id",v+"-selectized"),aA("label[for='"+v+"']").attr("for",v+"-selectized")),t.settings.copyClassesToDropdown&&C.addClass(y),F.css({width:H[0].style.width}),t.plugins.names.length&&(x="plugin-"+t.plugins.names.join(" plugin-"),F.addClass(x),C.addClass(x)),(null===s.maxItems||s.maxItems>1)&&t.tagType===ae&&H.attr("multiple","multiple"),t.settings.placeholder&&D.attr("placeholder",s.placeholder),!t.settings.splitOn&&t.settings.delimiter){var G=t.settings.delimiter.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");t.settings.splitOn=new RegExp("\\s*"+G+"+\\s*")}H.attr("autocorrect")&&D.attr("autocorrect",H.attr("autocorrect")),H.attr("autocapitalize")&&D.attr("autocapitalize",H.attr("autocapitalize")),t.$wrapper=F,t.$control=E,t.$control_input=D,t.$dropdown=C,t.$dropdown_content=B,C.on("mouseenter","[data-selectable]",function(){return t.onOptionHover.apply(t,arguments)}),C.on("mousedown click","[data-selectable]",function(){return t.onOptionSelect.apply(t,arguments)}),U(E,"mousedown","*:not(input)",function(){return t.onItemSelect.apply(t,arguments)}),Q(D),E.on({mousedown:function(){return t.onMouseDown.apply(t,arguments)},click:function(){return t.onClick.apply(t,arguments)}}),D.on({mousedown:function(b){b.stopPropagation()},keydown:function(){return t.onKeyDown.apply(t,arguments)},keyup:function(){return t.onKeyUp.apply(t,arguments)},keypress:function(){return t.onKeyPress.apply(t,arguments)},resize:function(){t.positionDropdown.apply(t,[])},blur:function(){return t.onBlur.apply(t,arguments)},focus:function(){return t.ignoreBlur=!1,t.onFocus.apply(t,arguments)},paste:function(){return t.onPaste.apply(t,arguments)}}),a.on("keydown"+r,function(b){t.isCmdDown=b[av?"metaKey":"ctrlKey"],t.isCtrlDown=b[av?"altKey":"ctrlKey"],t.isShiftDown=b.shiftKey}),a.on("keyup"+r,function(b){b.keyCode===ag&&(t.isCtrlDown=!1),b.keyCode===ai&&(t.isShiftDown=!1),b.keyCode===ah&&(t.isCmdDown=!1)}),a.on("mousedown"+r,function(b){if(t.isFocused){if(b.target===t.$dropdown[0]||b.target.parentNode===t.$dropdown[0]){return !1}t.$control.has(b.target).length||b.target===t.$control[0]||t.blur(b.target)}}),f.on(["scroll"+r,"resize"+r].join(" "),function(){t.isOpen&&t.positionDropdown.apply(t,arguments)}),f.on("mousemove"+r,function(){t.ignoreHover=!1}),this.revertSettings={$children:H.children().detach(),tabindex:H.attr("tabindex")},H.attr("tabindex",-1).hide().after(t.$wrapper),aA.isArray(s.items)&&(t.setValue(s.items),delete s.items),ac&&H.on("invalid"+r,function(b){b.preventDefault(),t.isInvalid=!0,t.refreshState()}),t.updateOriginalInput(),t.refreshItems(),t.refreshState(),t.updatePlaceholder(),t.isSetup=!0,H.is(":disabled")&&t.disable(),t.on("change",this.onChange),H.data("selectize",t),H.addClass("selectized"),t.trigger("initialize"),s.preload===!0&&t.onSearchChange("")},setupTemplates:function(){var a=this,h=a.settings.labelField,g=a.settings.optgroupLabelField,f={optgroup:function(b){return'<div class="optgroup">'+b.html+"</div>"},optgroup_header:function(d,c){return'<div class="optgroup-header">'+c(d[g])+"</div>"},option:function(d,c){return'<div class="option">'+c(d[h])+"</div>"},item:function(d,c){return'<div class="item">'+c(d[h])+"</div>"},option_create:function(d,c){return'<div class="create">Add <strong>'+c(d.input)+"</strong>&hellip;</div>"}};a.settings.render=aA.extend({},f,a.settings.render)},setupCallbacks:function(){var e,d,f={initialize:"onInitialize",change:"onChange",item_add:"onItemAdd",item_remove:"onItemRemove",clear:"onClear",option_add:"onOptionAdd",option_remove:"onOptionRemove",option_clear:"onOptionClear",optgroup_add:"onOptionGroupAdd",optgroup_remove:"onOptionGroupRemove",optgroup_clear:"onOptionGroupClear",dropdown_open:"onDropdownOpen",dropdown_close:"onDropdownClose",type:"onType",load:"onLoad",focus:"onFocus",blur:"onBlur"};for(e in f){f.hasOwnProperty(e)&&(d=this.settings[f[e]],d&&this.on(e,d))}},onClick:function(d){var c=this;c.isFocused||(c.focus(),d.preventDefault())},onMouseDown:function(a){var f=this,e=a.isDefaultPrevented();aA(a.target);if(f.isFocused){if(a.target!==f.$control_input[0]){return"single"===f.settings.mode?f.isOpen?f.close():f.open():e||f.setActiveItem(null),!1}}else{e||window.setTimeout(function(){f.focus()},0)}},onChange:function(){this.$input.trigger("change")},onPaste:function(a){var d=this;return d.isFull()||d.isInputHidden||d.isLocked?void a.preventDefault():void (d.settings.splitOn&&setTimeout(function(){var c=d.$control_input.val();if(c.match(d.settings.splitOn)){for(var i=aA.trim(c).split(d.settings.splitOn),h=0,g=i.length;h<g;h++){d.createItem(i[h])}}},0))},onKeyPress:function(d){if(this.isLocked){return d&&d.preventDefault()}var c=String.fromCharCode(d.keyCode||d.which);return this.settings.create&&"multi"===this.settings.mode&&c===this.settings.delimiter?(this.createItem(),d.preventDefault(),!1):void 0},onKeyDown:function(f){var e=(f.target===this.$control_input[0],this);if(e.isLocked){return void (f.keyCode!==af&&f.preventDefault())}switch(f.keyCode){case au:if(e.isCmdDown){return void e.selectAll()}break;case ar:return void (e.isOpen&&(f.preventDefault(),f.stopPropagation(),e.close()));case al:if(!f.ctrlKey||f.altKey){break}case am:if(!e.isOpen&&e.hasOptions){e.open()}else{if(e.$activeOption){e.ignoreHover=!0;var h=e.getAdjacentOption(e.$activeOption,1);h.length&&e.setActiveOption(h,!0,!0)}}return void f.preventDefault();case ao:if(!f.ctrlKey||f.altKey){break}case ap:if(e.$activeOption){e.ignoreHover=!0;var g=e.getAdjacentOption(e.$activeOption,-1);g.length&&e.setActiveOption(g,!0,!0)}return void f.preventDefault();case at:return void (e.isOpen&&e.$activeOption&&(e.onOptionSelect({currentTarget:e.$activeOption}),f.preventDefault()));case aq:return void e.advanceSelection(-1,f);case an:return void e.advanceSelection(1,f);case af:return e.settings.selectOnTab&&e.isOpen&&e.$activeOption&&(e.onOptionSelect({currentTarget:e.$activeOption}),e.isFull()||f.preventDefault()),void (e.settings.create&&e.createItem()&&f.preventDefault());case ak:case aj:return void e.deleteSelection(f)}return !e.isFull()&&!e.isInputHidden||(av?f.metaKey:f.ctrlKey)?void 0:void f.preventDefault()},onKeyUp:function(e){var d=this;if(d.isLocked){return e&&e.preventDefault()}var f=d.$control_input.val()||"";d.lastValue!==f&&(d.lastValue=f,d.onSearchChange(f),d.refreshOptions(),d.trigger("type",f))},onSearchChange:function(e){var d=this,f=d.settings.load;f&&(d.loadedSearches.hasOwnProperty(e)||(d.loadedSearches[e]=!0,d.load(function(a){f.apply(d,[e,a])})))},onFocus:function(e){var d=this,f=d.isFocused;return d.isDisabled?(d.blur(),e&&e.preventDefault(),!1):void (d.ignoreFocus||(d.isFocused=!0,"focus"===d.settings.preload&&d.onSearchChange(""),f||d.trigger("focus"),d.$activeItems.length||(d.showInput(),d.setActiveItem(null),d.refreshOptions(!!d.settings.openOnFocus)),d.refreshState()))},onBlur:function(f,e){var h=this;if(h.isFocused&&(h.isFocused=!1,!h.ignoreFocus)){if(!h.ignoreBlur&&document.activeElement===h.$dropdown_content[0]){return h.ignoreBlur=!0,void h.onFocus(f)}var g=function(){h.close(),h.setTextboxValue(""),h.setActiveItem(null),h.setActiveOption(null),h.setCaret(h.items.length),h.refreshState(),e&&e.focus&&e.focus(),h.ignoreFocus=!1,h.trigger("blur")};h.ignoreFocus=!0,h.settings.create&&h.settings.createOnBlur?h.createItem(null,!1,g):g()}},onOptionHover:function(b){this.ignoreHover||this.setActiveOption(b.currentTarget,!1)},onOptionSelect:function(a){var h,g,f=this;a.preventDefault&&(a.preventDefault(),a.stopPropagation()),g=aA(a.currentTarget),g.hasClass("create")?f.createItem(null,function(){f.settings.closeAfterSelect&&f.close()}):(h=g.attr("data-value"),"undefined"!=typeof h&&(f.lastQuery=null,f.setTextboxValue(""),f.addItem(h),f.settings.closeAfterSelect?f.close():!f.settings.hideSelected&&a.type&&/mouse/.test(a.type)&&f.setActiveOption(f.getOption(h))))},onItemSelect:function(d){var c=this;c.isLocked||"multi"===c.settings.mode&&(d.preventDefault(),c.setActiveItem(d.currentTarget,d))},load:function(e){var d=this,f=d.$wrapper.addClass(d.settings.loadingClass);d.loading++,e.apply(d,[function(b){d.loading=Math.max(d.loading-1,0),b&&b.length&&(d.addOption(b),d.refreshOptions(d.isFocused&&!d.isInputHidden)),d.loading||f.removeClass(d.settings.loadingClass),d.trigger("load",b)}])},setTextboxValue:function(e){var d=this.$control_input,f=d.val()!==e;f&&(d.val(e).triggerHandler("update"),this.lastValue=e)},getValue:function(){return this.tagType===ae&&this.$input.attr("multiple")?this.items:this.items.join(this.settings.delimiter)},setValue:function(e,d){var f=d?[]:["change"];V(this,f,function(){this.clear(d),this.addItems(e,d)})},setActiveItem:function(v,u){var t,s,r,q,p,o,n,m,a=this;if("single"!==a.settings.mode){if(v=aA(v),!v.length){return aA(a.$activeItems).removeClass("active"),a.$activeItems=[],void (a.isFocused&&a.showInput())}if(t=u&&u.type.toLowerCase(),"mousedown"===t&&a.isShiftDown&&a.$activeItems.length){for(m=a.$control.children(".active:last"),q=Array.prototype.indexOf.apply(a.$control[0].childNodes,[m[0]]),p=Array.prototype.indexOf.apply(a.$control[0].childNodes,[v[0]]),q>p&&(n=q,q=p,p=n),s=q;s<=p;s++){o=a.$control[0].childNodes[s],a.$activeItems.indexOf(o)===-1&&(aA(o).addClass("active"),a.$activeItems.push(o))}u.preventDefault()}else{"mousedown"===t&&a.isCtrlDown||"keydown"===t&&this.isShiftDown?v.hasClass("active")?(r=a.$activeItems.indexOf(v[0]),a.$activeItems.splice(r,1),v.removeClass("active")):a.$activeItems.push(v.addClass("active")[0]):(aA(a.$activeItems).removeClass("active"),a.$activeItems=[v.addClass("active")[0]])}a.hideInput(),this.isFocused||a.focus()}},setActiveOption:function(r,q,p){var o,n,m,l,k,a=this;a.$activeOption&&a.$activeOption.removeClass("active"),a.$activeOption=null,r=aA(r),r.length&&(a.$activeOption=r.addClass("active"),!q&&ab(q)||(o=a.$dropdown_content.height(),n=a.$activeOption.outerHeight(!0),q=a.$dropdown_content.scrollTop()||0,m=a.$activeOption.offset().top-a.$dropdown_content.offset().top+q,l=m,k=m-o+n,m+n>o+q?a.$dropdown_content.stop().animate({scrollTop:k},p?a.settings.scrollDuration:0):m<q&&a.$dropdown_content.stop().animate({scrollTop:l},p?a.settings.scrollDuration:0)))},selectAll:function(){var b=this;"single"!==b.settings.mode&&(b.$activeItems=Array.prototype.slice.apply(b.$control.children(":not(input)").addClass("active")),b.$activeItems.length&&(b.hideInput(),b.close()),b.focus())},hideInput:function(){var b=this;b.setTextboxValue(""),b.$control_input.css({opacity:0,position:"absolute",left:b.rtl?10000:-10000}),b.isInputHidden=!0},showInput:function(){this.$control_input.css({opacity:1,position:"relative",left:0}),this.isInputHidden=!1},focus:function(){var b=this;b.isDisabled||(b.ignoreFocus=!0,b.$control_input[0].focus(),window.setTimeout(function(){b.ignoreFocus=!1,b.onFocus()},0))},blur:function(b){this.$control_input[0].blur(),this.onBlur(null,b)},getScoreFunction:function(b){return this.sifter.getScoreFunction(b,this.getSearchOptions())},getSearchOptions:function(){var d=this.settings,c=d.sortField;return"string"==typeof c&&(c=[{field:c}]),{fields:d.searchField,conjunction:d.searchConjunction,sort:c}},search:function(a){var n,m,l,k=this,j=k.settings,i=this.getSearchOptions();if(j.score&&(l=k.settings.score.apply(this,[a]),"function"!=typeof l)){throw new Error('Selectize "score" setting must be a function that returns a function')}if(a!==k.lastQuery?(k.lastQuery=a,m=k.sifter.search(a,aA.extend(i,{score:l})),k.currentResults=m):m=aA.extend(!0,{},k.currentResults),j.hideSelected){for(n=m.items.length-1;n>=0;n--){k.items.indexOf(aa(m.items[n].id))!==-1&&m.items.splice(n,1)}}return m},refreshOptions:function(aF){var aE,aD,aC,aB,M,L,K,J,I,H,G,F,E,D,C,B;"undefined"==typeof aF&&(aF=!0);var A=this,z=aA.trim(A.$control_input.val()),y=A.search(z),d=A.$dropdown_content,a=A.$activeOption&&aa(A.$activeOption.attr("data-value"));for(aB=y.items.length,"number"==typeof A.settings.maxOptions&&(aB=Math.min(aB,A.settings.maxOptions)),M={},L=[],aE=0;aE<aB;aE++){for(K=A.options[y.items[aE].id],J=A.render("option",K),I=K[A.settings.optgroupField]||"",H=aA.isArray(I)?I:[I],aD=0,aC=H&&H.length;aD<aC;aD++){I=H[aD],A.optgroups.hasOwnProperty(I)||(I=""),M.hasOwnProperty(I)||(M[I]=document.createDocumentFragment(),L.push(I)),M[I].appendChild(J)}}for(this.settings.lockOptgroupOrder&&L.sort(function(f,e){var h=A.optgroups[f].$order||0,g=A.optgroups[e].$order||0;return h-g}),G=document.createDocumentFragment(),aE=0,aB=L.length;aE<aB;aE++){I=L[aE],A.optgroups.hasOwnProperty(I)&&M[I].childNodes.length?(F=document.createDocumentFragment(),F.appendChild(A.render("optgroup_header",A.optgroups[I])),F.appendChild(M[I]),G.appendChild(A.render("optgroup",aA.extend({},A.optgroups[I],{html:P(F),dom:F})))):G.appendChild(M[I])}if(d.html(G),A.settings.highlight&&y.query.length&&y.tokens.length){for(d.removeHighlight(),aE=0,aB=y.tokens.length;aE<aB;aE++){ax(d,y.tokens[aE].regex)}}if(!A.settings.hideSelected){for(aE=0,aB=A.items.length;aE<aB;aE++){A.getOption(A.items[aE]).addClass("selected")}}E=A.canCreate(z),E&&(d.prepend(A.render("option_create",{input:z})),B=aA(d[0].childNodes[0])),A.hasOptions=y.items.length>0||E,A.hasOptions?(y.items.length>0?(C=a&&A.getOption(a),C&&C.length?D=C:"single"===A.settings.mode&&A.items.length&&(D=A.getOption(A.items[0])),D&&D.length||(D=B&&!A.settings.addPrecedence?A.getAdjacentOption(B,1):d.find("[data-selectable]:first"))):D=B,A.setActiveOption(D),aF&&!A.isOpen&&A.open()):(A.setActiveOption(null),aF&&A.isOpen&&A.close())},addOption:function(a){var j,i,h,g=this;if(aA.isArray(a)){for(j=0,i=a.length;j<i;j++){g.addOption(a[j])}}else{(h=g.registerOption(a))&&(g.userOptions[h]=!0,g.lastQuery=null,g.trigger("option_add",h,a))}},registerOption:function(d){var c=aa(d[this.settings.valueField]);return"undefined"!=typeof c&&null!==c&&!this.options.hasOwnProperty(c)&&(d.$order=d.$order||++this.order,this.options[c]=d,c)},registerOptionGroup:function(d){var c=aa(d[this.settings.optgroupValueField]);return !!c&&(d.$order=d.$order||++this.order,this.optgroups[c]=d,c)},addOptionGroup:function(d,c){c[this.settings.optgroupValueField]=d,(d=this.registerOptionGroup(c))&&this.trigger("optgroup_add",d,c)},removeOptionGroup:function(b){this.optgroups.hasOwnProperty(b)&&(delete this.optgroups[b],this.renderCache={},this.trigger("optgroup_remove",b))},clearOptionGroups:function(){this.optgroups={},this.renderCache={},this.trigger("optgroup_clear")},updateOption:function(t,s){var r,q,p,o,n,m,l,a=this;if(t=aa(t),p=aa(s[a.settings.valueField]),null!==t&&a.options.hasOwnProperty(t)){if("string"!=typeof p){throw new Error("Value must be set in option data")}l=a.options[t].$order,p!==t&&(delete a.options[t],o=a.items.indexOf(t),o!==-1&&a.items.splice(o,1,p)),s.$order=s.$order||l,a.options[p]=s,n=a.renderCache.item,m=a.renderCache.option,n&&(delete n[t],delete n[p]),m&&(delete m[t],delete m[p]),a.items.indexOf(p)!==-1&&(r=a.getItem(t),q=aA(a.render("item",s)),r.hasClass("active")&&q.addClass("active"),r.replaceWith(q)),a.lastQuery=null,a.isOpen&&a.refreshOptions(!1)}},removeOption:function(g,f){var j=this;g=aa(g);var i=j.renderCache.item,h=j.renderCache.option;i&&delete i[g],h&&delete h[g],delete j.userOptions[g],delete j.options[g],j.lastQuery=null,j.trigger("option_remove",g),j.removeItem(g,f)},clearOptions:function(){var b=this;b.loadedSearches={},b.userOptions={},b.renderCache={},b.options=b.sifter.items={},b.lastQuery=null,b.trigger("option_clear"),b.clear()},getOption:function(b){return this.getElementWithValue(b,this.$dropdown_content.find("[data-selectable]"))},getAdjacentOption:function(a,h){var g=this.$dropdown.find("[data-selectable]"),f=g.index(a)+h;return f>=0&&f<g.length?g.eq(f):aA()},getElementWithValue:function(a,h){if(a=aa(a),"undefined"!=typeof a&&null!==a){for(var g=0,f=h.length;g<f;g++){if(h[g].getAttribute("data-value")===a){return aA(h[g])}}}return aA()},getItem:function(b){return this.getElementWithValue(b,this.$control.children())},addItems:function(a,j){for(var i=aA.isArray(a)?a:[a],h=0,g=i.length;h<g;h++){this.isPending=h<g-1,this.addItem(i[h],j)}},addItem:function(a,f){var e=f?[]:["change"];V(this,e,function(){var o,n,m,l,k,c=this,b=c.settings.mode;return a=aa(a),c.items.indexOf(a)!==-1?void ("single"===b&&c.close()):void (c.options.hasOwnProperty(a)&&("single"===b&&c.clear(f),"multi"===b&&c.isFull()||(o=aA(c.render("item",c.options[a])),k=c.isFull(),c.items.splice(c.caretPos,0,a),c.insertAtCaret(o),(!c.isPending||!k&&c.isFull())&&c.refreshState(),c.isSetup&&(m=c.$dropdown_content.find("[data-selectable]"),c.isPending||(n=c.getOption(a),l=c.getAdjacentOption(n,1).attr("data-value"),c.refreshOptions(c.isFocused&&"single"!==b),l&&c.setActiveOption(c.getOption(l))),!m.length||c.isFull()?c.close():c.positionDropdown(),c.updatePlaceholder(),c.trigger("item_add",a,o),c.updateOriginalInput({silent:f})))))})},removeItem:function(a,l){var k,j,i,h=this;k=a instanceof aA?a:h.getItem(a),a=aa(k.attr("data-value")),j=h.items.indexOf(a),j!==-1&&(k.remove(),k.hasClass("active")&&(i=h.$activeItems.indexOf(k[0]),h.$activeItems.splice(i,1)),h.items.splice(j,1),h.lastQuery=null,!h.settings.persist&&h.userOptions.hasOwnProperty(a)&&h.removeOption(a,l),j<h.caretPos&&h.setCaret(h.caretPos-1),h.refreshState(),h.updatePlaceholder(),h.updateOriginalInput({silent:l}),h.positionDropdown(),h.trigger("item_remove",a,k))},createItem:function(a,p){var o=this,n=o.caretPos;a=a||aA.trim(o.$control_input.val()||"");var m=arguments[arguments.length-1];if("function"!=typeof m&&(m=function(){}),"boolean"!=typeof p&&(p=!0),!o.canCreate(a)){return m(),!1}o.lock();var l="function"==typeof o.settings.create?this.settings.create:function(d){var c={};return c[o.settings.labelField]=d,c[o.settings.valueField]=d,c},k=X(function(d){if(o.unlock(),!d||"object"!=typeof d){return m()}var c=aa(d[o.settings.valueField]);return"string"!=typeof c?m():(o.setTextboxValue(""),o.addOption(d),o.setCaret(n),o.addItem(c),o.refreshOptions(p&&"single"!==o.settings.mode),void m(d))}),j=l.apply(this,[a,k]);return"undefined"!=typeof j&&k(j),!0},refreshItems:function(){this.lastQuery=null,this.isSetup&&this.addItem(this.items),this.refreshState(),this.updateOriginalInput()},refreshState:function(){this.refreshValidityState(),this.refreshClasses()},refreshValidityState:function(){if(!this.isRequired){return !1}var b=!this.items.length;this.isInvalid=b,this.$control_input.prop("required",b),this.$input.prop("required",!b)},refreshClasses:function(){var a=this,f=a.isFull(),e=a.isLocked;a.$wrapper.toggleClass("rtl",a.rtl),a.$control.toggleClass("focus",a.isFocused).toggleClass("disabled",a.isDisabled).toggleClass("required",a.isRequired).toggleClass("invalid",a.isInvalid).toggleClass("locked",e).toggleClass("full",f).toggleClass("not-full",!f).toggleClass("input-active",a.isFocused&&!a.isInputHidden).toggleClass("dropdown-active",a.isOpen).toggleClass("has-options",!aA.isEmptyObject(a.options)).toggleClass("has-items",a.items.length>0),a.$control_input.data("grow",!f&&!e)},isFull:function(){return null!==this.settings.maxItems&&this.items.length>=this.settings.maxItems},updateOriginalInput:function(h){var g,l,k,j,i=this;if(h=h||{},i.tagType===ae){for(k=[],g=0,l=i.items.length;g<l;g++){j=i.options[i.items[g]][i.settings.labelField]||"",k.push('<option value="'+Z(i.items[g])+'" selected="selected">'+Z(j)+"</option>")}k.length||this.$input.attr("multiple")||k.push('<option value="" selected="selected"></option>'),i.$input.html(k.join(""))}else{i.$input.val(i.getValue()),i.$input.attr("value",i.$input.val())}i.isSetup&&(h.silent||i.trigger("change",i.$input.val()))},updatePlaceholder:function(){if(this.settings.placeholder){var b=this.$control_input;this.items.length?b.removeAttr("placeholder"):b.attr("placeholder",this.settings.placeholder),b.triggerHandler("update",{force:!0})}},open:function(){var b=this;b.isLocked||b.isOpen||"multi"===b.settings.mode&&b.isFull()||(b.focus(),b.isOpen=!0,b.refreshState(),b.$dropdown.css({visibility:"hidden",display:"block"}),b.positionDropdown(),b.$dropdown.css({visibility:"visible"}),b.trigger("dropdown_open",b.$dropdown))},close:function(){var d=this,c=d.isOpen;"single"===d.settings.mode&&d.items.length&&(d.hideInput(),d.$control_input.blur()),d.isOpen=!1,d.$dropdown.hide(),d.setActiveOption(null),d.refreshState(),c&&d.trigger("dropdown_close",d.$dropdown)},positionDropdown:function(){var d=this.$control,c="body"===this.settings.dropdownParent?d.offset():d.position();c.top+=d.outerHeight(!0),this.$dropdown.css({width:d.outerWidth(),top:c.top,left:c.left})},clear:function(d){var c=this;c.items.length&&(c.$control.children(":not(input)").remove(),c.items=[],c.lastQuery=null,c.setCaret(0),c.setActiveItem(null),c.updatePlaceholder(),c.updateOriginalInput({silent:d}),c.refreshState(),c.showInput(),c.trigger("clear"))},insertAtCaret:function(a){var d=Math.min(this.caretPos,this.items.length);0===d?this.$control.prepend(a):aA(this.$control[0].childNodes[d]).before(a),this.setCaret(d+1)},deleteSelection:function(v){var u,t,s,r,q,p,o,n,m,a=this;if(s=v&&v.keyCode===ak?-1:1,r=T(a.$control_input[0]),a.$activeOption&&!a.settings.hideSelected&&(o=a.getAdjacentOption(a.$activeOption,-1).attr("data-value")),q=[],a.$activeItems.length){for(m=a.$control.children(".active:"+(s>0?"last":"first")),p=a.$control.children(":not(input)").index(m),s>0&&p++,u=0,t=a.$activeItems.length;u<t;u++){q.push(aA(a.$activeItems[u]).attr("data-value"))}v&&(v.preventDefault(),v.stopPropagation())}else{(a.isFocused||"single"===a.settings.mode)&&a.items.length&&(s<0&&0===r.start&&0===r.length?q.push(a.items[a.caretPos-1]):s>0&&r.start===a.$control_input.val().length&&q.push(a.items[a.caretPos]))}if(!q.length||"function"==typeof a.settings.onDelete&&a.settings.onDelete.apply(a,[q])===!1){return !1}for("undefined"!=typeof p&&a.setCaret(p);q.length;){a.removeItem(q.pop())}return a.showInput(),a.positionDropdown(),a.refreshOptions(!0),o&&(n=a.getOption(o),n.length&&a.setActiveOption(n)),!0},advanceSelection:function(r,q){var p,o,n,m,l,k,j=this;0!==r&&(j.rtl&&(r*=-1),p=r>0?"last":"first",o=T(j.$control_input[0]),j.isFocused&&!j.isInputHidden?(m=j.$control_input.val().length,l=r<0?0===o.start&&0===o.length:o.start===m,l&&!m&&j.advanceCaret(r,q)):(k=j.$control.children(".active:"+p),k.length&&(n=j.$control.children(":not(input)").index(k),j.setActiveItem(null),j.setCaret(r>0?n+1:n))))},advanceCaret:function(g,f){var j,i,h=this;0!==g&&(j=g>0?"next":"prev",h.isShiftDown?(i=h.$control_input[j](),i.length&&(h.hideInput(),h.setActiveItem(i),f&&f.preventDefault())):h.setCaret(h.caretPos+g))},setCaret:function(a){var l=this;if(a="single"===l.settings.mode?l.items.length:Math.max(0,Math.min(l.items.length,a)),!l.isPending){var k,j,i,h;for(i=l.$control.children(":not(input)"),k=0,j=i.length;k<j;k++){h=aA(i[k]).detach(),k<a?l.$control_input.before(h):l.$control.append(h)}}l.caretPos=a},lock:function(){this.close(),this.isLocked=!0,this.refreshState()},unlock:function(){this.isLocked=!1,this.refreshState()},disable:function(){var b=this;b.$input.prop("disabled",!0),b.$control_input.prop("disabled",!0).prop("tabindex",-1),b.isDisabled=!0,b.lock()},enable:function(){var b=this;b.$input.prop("disabled",!1),b.$control_input.prop("disabled",!1).prop("tabindex",b.tabIndex),b.isDisabled=!1,b.unlock()},destroy:function(){var a=this,f=a.eventNS,e=a.revertSettings;a.trigger("destroy"),a.off(),a.$wrapper.remove(),a.$dropdown.remove(),a.$input.html("").append(e.$children).removeAttr("tabindex").removeClass("selectized").attr({tabindex:e.tabindex}).show(),a.$control_input.removeData("grow"),a.$input.removeData("selectize"),aA(window).off(f),aA(document).off(f),aA(document.body).off(f),delete a.$input[0].selectize},render:function(a,n){var m,l,k="",j=!1,i=this;return"option"!==a&&"item"!==a||(m=aa(n[i.settings.valueField]),j=!!m),j&&(ab(i.renderCache[a])||(i.renderCache[a]={}),i.renderCache[a].hasOwnProperty(m))?i.renderCache[a][m]:(k=aA(i.settings.render[a].apply(this,[n,Z])),"option"===a||"option_create"===a?k.attr("data-selectable",""):"optgroup"===a&&(l=n[i.settings.optgroupValueField]||"",k.attr("data-group",l)),"option"!==a&&"item"!==a||k.attr("data-value",m||""),j&&(i.renderCache[a][m]=k[0]),k[0])},clearCache:function(d){var c=this;"undefined"==typeof d?c.renderCache={}:delete c.renderCache[d]},canCreate:function(e){var d=this;if(!d.settings.create){return !1}var f=d.settings.createFilter;return e.length&&("function"!=typeof f||f.apply(d,[e]))&&("string"!=typeof f||new RegExp(f).test(e))&&(!(f instanceof RegExp)||f.test(e))}}),N.count=0,N.defaults={options:[],optgroups:[],plugins:[],delimiter:",",splitOn:null,persist:!0,diacritics:!0,create:!1,createOnBlur:!1,createFilter:null,highlight:!0,openOnFocus:!0,maxOptions:1000,maxItems:null,hideSelected:null,addPrecedence:!1,selectOnTab:!1,preload:!1,allowEmptyOption:!1,closeAfterSelect:!1,scrollDuration:60,loadThrottle:300,loadingClass:"loading",dataAttr:"data-data",optgroupField:"optgroup",valueField:"value",labelField:"text",optgroupLabelField:"label",optgroupValueField:"value",lockOptgroupOrder:!1,sortField:"$order",searchField:["text"],searchConjunction:"and",mode:null,wrapperClass:"selectize-control",inputClass:"selectize-input",dropdownClass:"selectize-dropdown",dropdownContentClass:"selectize-dropdown-content",dropdownParent:null,copyClassesToDropdown:!0,render:{}},aA.fn.selectize=function(v){var u=aA.fn.selectize.defaults,t=aA.extend({},u,v),s=t.dataAttr,r=t.labelField,q=t.valueField,p=t.optgroupField,o=t.optgroupLabelField,n=t.optgroupValueField,m=function(e,z){var y,x,w,g,f=e.attr(s);if(f){for(z.options=JSON.parse(f),y=0,x=z.options.length;y<x;y++){z.items.push(z.options[y][q])}}else{var d=aA.trim(e.val()||"");if(!t.allowEmptyOption&&!d.length){return}for(w=d.split(t.delimiter),y=0,x=w.length;y<x;y++){g={},g[r]=w[y],g[q]=w[y],z.options.push(g)}z.items=w}},a=function(y,x){var w,j,i,h,g=x.options,f={},e=function(k){var c=s&&k.attr(s);return"string"==typeof c&&c.length?JSON.parse(c):null},d=function(c,C){c=aA(c);var B=aa(c.val());if(B||t.allowEmptyOption){if(f.hasOwnProperty(B)){if(C){var A=f[B][p];A?aA.isArray(A)?A.push(C):f[B][p]=[A,C]:f[B][p]=C}}else{var l=e(c)||{};l[r]=l[r]||c.text(),l[q]=l[q]||B,l[p]=l[p]||C,f[B]=l,g.push(l),c.is(":selected")&&x.items.push(B)}}},z=function(c){var C,B,A,l,k;for(c=aA(c),A=c.attr("label"),A&&(l=e(c)||{},l[o]=A,l[n]=A,x.optgroups.push(l)),k=aA("option",c),C=0,B=k.length;C<B;C++){d(k[C],A)}};for(x.maxItems=y.attr("multiple")?null:1,h=y.children(),w=0,j=h.length;w<j;w++){i=h[w].tagName.toLowerCase(),"optgroup"===i?z(h[w]):"option"===i&&d(h[w])}};return this.each(function(){if(!this.selectize){var k,j=aA(this),d=this.tagName.toLowerCase(),c=j.attr("placeholder")||j.attr("data-placeholder");c||t.allowEmptyOption||(c=j.children('option[value=""]').text());var b={placeholder:c,options:[],optgroups:[],items:[]};"select"===d?a(j,b):m(j,b),k=new N(j,aA.extend(!0,{},u,b,v))}})},aA.fn.selectize.defaults=N.defaults,aA.fn.selectize.support={validity:ac},N.define("drag_drop",function(a){if(!aA.fn.sortable){throw new Error('The "drag_drop" plugin requires jQuery UI "sortable".')}if("multi"===this.settings.mode){var d=this;d.lock=function(){var b=d.lock;return function(){var c=d.$control.data("sortable");return c&&c.disable(),b.apply(d,arguments)}}(),d.unlock=function(){var b=d.unlock;return function(){var c=d.$control.data("sortable");return c&&c.enable(),b.apply(d,arguments)}}(),d.setup=function(){var c=d.setup;return function(){c.apply(this,arguments);var b=d.$control.sortable({items:"[data-value]",forcePlaceholderSize:!0,disabled:d.isLocked,start:function(f,e){e.placeholder.css("width",e.helper.css("width")),b.css({overflow:"visible"})},stop:function(){b.css({overflow:"hidden"});var f=d.$activeItems?d.$activeItems.slice():null,g=[];b.children("[data-value]").each(function(){g.push(aA(this).attr("data-value"))}),d.setValue(g),d.setActiveItem(f)}})}}()}}),N.define("dropdown_header",function(a){var d=this;a=aA.extend({title:"Untitled",headerClass:"selectize-dropdown-header",titleRowClass:"selectize-dropdown-header-title",labelClass:"selectize-dropdown-header-label",closeClass:"selectize-dropdown-header-close",html:function(b){return'<div class="'+b.headerClass+'"><div class="'+b.titleRowClass+'"><span class="'+b.labelClass+'">'+b.title+'</span><a href="javascript:void(0)" class="'+b.closeClass+'">&times;</a></div></div>'}},a),d.setup=function(){var b=d.setup;return function(){b.apply(d,arguments),d.$dropdown_header=aA(a.html(a)),d.$dropdown.prepend(d.$dropdown_header)}}()}),N.define("optgroup_columns",function(a){var h=this;a=aA.extend({equalizeWidth:!0,equalizeHeight:!0},a),this.getAdjacentOption=function(i,l){var k=i.closest("[data-group]").find("[data-selectable]"),j=k.index(i)+l;return j>=0&&j<k.length?k.eq(j):aA()},this.onKeyDown=function(){var b=h.onKeyDown;return function(c){var l,k,j,i;return !this.isOpen||c.keyCode!==aq&&c.keyCode!==an?b.apply(this,arguments):(h.ignoreHover=!0,i=this.$activeOption.closest("[data-group]"),l=i.find("[data-selectable]").index(this.$activeOption),i=c.keyCode===aq?i.prev("[data-group]"):i.next("[data-group]"),j=i.find("[data-selectable]"),k=j.eq(Math.min(j.length-1,l)),void (k.length&&this.setActiveOption(k)))}}();var g=function(){var e,d=g.width,i=document;return"undefined"==typeof d&&(e=i.createElement("div"),e.innerHTML='<div style="width:50px;height:50px;position:absolute;left:-50px;top:-50px;overflow:auto;"><div style="width:1px;height:100px;"></div></div>',e=e.firstChild,i.body.appendChild(e),d=g.width=e.offsetWidth-e.clientWidth,i.body.removeChild(e)),d},f=function(){var o,n,m,l,d,c,b;if(b=aA("[data-group]",h.$dropdown_content),n=b.length,n&&h.$dropdown_content.width()){if(a.equalizeHeight){for(m=0,o=0;o<n;o++){m=Math.max(m,b.eq(o).height())}b.css({height:m})}a.equalizeWidth&&(c=h.$dropdown_content.innerWidth()-g(),l=Math.round(c/n),b.css({width:l}),n>1&&(d=c-l*(n-1),b.eq(n-1).css({width:d})))}};(a.equalizeHeight||a.equalizeWidth)&&(Y.after(this,"positionDropdown",f),Y.after(this,"refreshOptions",f))}),N.define("remove_button",function(a){a=aA.extend({label:"&times;",title:"Remove",className:"remove",append:!0},a);var f=function(g,k){k.className="remove-single";var j=g,i='<a href="javascript:void(0)" class="'+k.className+'" tabindex="-1" title="'+Z(k.title)+'">'+k.label+"</a>",h=function(d,c){return d+c};g.setup=function(){var b=j.setup;return function(){if(k.append){var d=aA(j.$input.context).attr("id"),c=(aA("#"+d),j.settings.render.item);j.settings.render.item=function(l){return h(c.apply(g,arguments),i)}}b.apply(g,arguments),g.$control.on("click","."+k.className,function(l){l.preventDefault(),j.isLocked||j.clear()})}}()},e=function(g,k){var j=g,i='<a href="javascript:void(0)" class="'+k.className+'" tabindex="-1" title="'+Z(k.title)+'">'+k.label+"</a>",h=function(l,d){var m=l.search(/(<\/[^>]+>\s*)$/);return l.substring(0,m)+d+l.substring(m)};g.setup=function(){var b=j.setup;return function(){if(k.append){var c=j.settings.render.item;j.settings.render.item=function(d){return h(c.apply(g,arguments),i)}}b.apply(g,arguments),g.$control.on("click","."+k.className,function(d){if(d.preventDefault(),!j.isLocked){var l=aA(d.currentTarget).parent();j.setActiveItem(l),j.deleteSelection()&&j.setCaret(j.items.length)}})}}()};return"single"===this.settings.mode?void f(this,a):void e(this,a)}),N.define("restore_on_backspace",function(d){var c=this;d.text=d.text||function(b){return b[this.settings.labelField]},this.onKeyDown=function(){var a=c.onKeyDown;return function(f){var h,g;return f.keyCode===ak&&""===this.$control_input.val()&&!this.$activeItems.length&&(h=this.caretPos-1,h>=0&&h<this.items.length)?(g=this.options[this.items[h]],this.deleteSelection(f)&&(this.setTextboxValue(d.text.apply(this,[g])),this.refreshOptions(!0)),void f.preventDefault()):a.apply(this,arguments)}}()}),N});