#!/usr/bin/env bash
{ set +x; } 2>/dev/null

IFS=
usage="usage: ${BASH_SOURCE[0]} name ..."

[[ $1 == "--help" ]] && {
    echo "$usage"
    [[ $1 == "--help" ]]; exit # exit 0 if --help
}

# https://www.npmjs.com/package/name

while [[ $# != 0 ]]; do
    name="$1"
    shift
    url="https://www.npmjs.com/package/$name"
    ( set -x; curl -f -I -L -sS -o /dev/null "$url" ) && echo "SKIP: $name EXISTS, $url" && continue
    path="$(mktemp -d)" || exit
    # { set -x; cd "$path" || exit; { set +x; } 2>/dev/null; }
    cd "$path" || exit
    cat <<EOF > package.json
{
  "name": "$name",
  "version": "0.0.0"
}
EOF
    ( set -x; npm publish ) || exit
    echo "$url"
done;:
