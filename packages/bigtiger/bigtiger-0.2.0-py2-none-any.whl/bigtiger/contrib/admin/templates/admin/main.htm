{% extends "admin/base.htm" %}
{% load static %}

{% block head %}
{{ block.super }}
<style type="text/css">
	body{background-color: #ffffff; } 
	.box {margin-bottom: 0px; } 
	.box_title {background: #e6e9eb; color: #46505c; font-family: gotham,Hiragino Sans GB,STHeiti,Microsoft Yahei,helvetica,arial,sans-serif; font-size: 14px; font-weight: bold; height: 38px; line-height: 38px; text-indent: 10px; border-left: 3px solid #4285f4; } 
	.box_content {margin-top: 1px; } 
	.box_title {position: relative;} 
	.box_title .btns {position: absolute;right: 10px;top: 0px;} 
	.box_title .btn {margin-right: 10px;} 
	.searchWrapper {position: relative; border-left: 3px solid #34a853; } 
	.search {padding: 8px 10px; margin-bottom: 1px; } 
	.gridWrapper {overflow: hidden;overflow-x: auto;} 
	a.detail {color: #4D90FE;} 
	a.detail:hover{text-decoration: underline;} 
	.container-fluid {
	}
	.gridWrapper {
		/*background-color: blue;*/
	}

	.btns .btn {
		display: none;
	}

	.irr-list {
	    background-color: #eaedf1;
	}
	.irr-list-title {
	    background: #d9dee4 none repeat scroll 0 0;
	    font-weight: bold;
	    height: 38px;
	    line-height: 38px;
	    overflow: hidden;
	    text-indent: 10px;
	    text-overflow: ellipsis;
	    white-space: nowrap;
	}
	.irr-list-main {
	    overflow-x: hidden;
	    overflow-y: auto;
	    padding-top: 5px;
	}
	.irr-list ul {
		padding-left: 0px;
	}

	.irr-list .irr-list-main .irr-list-item {
		border-radius: 1.5rem;
	    display: block;
	    padding: 3px 3px;
	    text-decoration: none;
	}

	.irr-list ul li.selected {
		 background-color: #3c95c8;
	}

	.irr-list ul li:hover {
	    background-color: #c9d1d7;
	    border: 1px none #c4cbcf;
	    outline: 0 none;
	}

	.irr-list ul li a {
		display: block;
		text-indent: 10px;
		color: #333;
	}

	.irr-list ul li:hover a {
		color: #333;
	}

	.irr-list ul li.selected a {
		color: #fff;
	}
</style>
{% endblock %}

{% block body %}
<div class="wrapper">
	<div class="viewFramework-head">
		<div class="header">
			<div class="header_logo clearfix">
				{% block sys_logo %}
				<img class="logo" src="{% static 'iconstore/logo.png' %}" alt="系统logo">
				{% endblock %}
				{% block sys_name %}
				<h1 class="sys_name">{{ sysconf.sys_name }}</h1>
				{% endblock %}
			</div>

			{% block toolbar_nav %}
			<div class="toolbar_nav dropdown clearfix">
				<a class="dropdown-toggle topbar-btn topbar-nav-btn" data-toggle="dropdown" href="#">
					<span class="nav_text">菜单清单</span><span class="icon-arrow-down nav_text W_ficon">g</span>
				</a>
				<div class="dropdown-menu topbar-nav-list topbar-clearfix">
					{% for col in cols %}
					<div class="topbar-nav-col">
						{% for line in col %}
						<div class="topbar-nav-item">
							{% if line.Name %}
							<p class="topbar-nav-item-title">{{ line.Name }}</p>
							{% endif %}
							{% if line.Childs %}
								<ul>
								{% for line1 in line.Childs %}
									<li data-menu="{{ line1.Id }}" data-mainMenu = "{{ line1.MainMenuId }}">
										<a href="{{ line1.Url }}">
											<span class="topbar-nav-item-icon"></span>
											<span>{{ line1.Name }}</span>
										</a>
									</li>
								{% endfor %}
								</ul>
								{% if not forloop.last %}<div class="topbar-nav-gap"></div>{%endif%}
							{% endif %}
						</div>
						{% endfor %}
					</div>
					{% endfor %}
				</div>
			</div>
			{% endblock %}

			<div class="header_nav clearfix">
				<ul>
					{% for item in root_menu.childs %}
					<li {% if forloop.first %}class="first selected"{%endif%} data-menu='{{ item.id }}'>
						<a href="{% if item.menu_url %}{{ item.menu_url }}{% else %}/base/navigate/?id={{ item.id }}{% endif %}
						target="frameCon">
							<img class="nav_icon" src="{% static '/static/iconstore/32x32/' %}{%if item.big_icon %}{{ item.big_icon }}{%else%}default.png{%endif%}" alt="{{ item.menu_name }}" />
							<span class="nav_text">{{ item.menu_name }}</span>
							<i id="app-notice-num" class="notice-num">{{ item.badge }}</i>
						</a>
					</li>
					{% endfor %}
				</ul>
			</div>

			<div class="header_user clearfix">
				<ul class="clearfix">
					<li><span>您好：</span><span style="color:#64ff50; font-size:14px; font-weight: bold;">{{user.first_name}}{{user.last_name}}</span></li>
					<li class="dropdown">
						<a class="dropdown-toggle" data-toggle="dropdown" href="#">
							<img src="{% static '/static/iconstore/16x16/icon_more.png' %}" />
						</a>
						<ul class="header_user_menu dropdown-menu">
							<li id="modify_pwd" class="icon_change"><a href="javascript:modifyPwd()">修改密码</a></li>
							<li id="change_user" class="icon_reset"><a href="/">切换用户</a></li>
							<li id="exit_sys" class="icon_exit"><a href="/base/user/logout/">退出</a></li>
						</ul>
					</li>
				</ul>
			</div>

			<div id="weather" class="clearfix">
			</div>
		</div>
	</div>
	<div class="viewFramework-head-offset"></div>

	<div class="viewFramework-body viewFramework-sidebar-none main clearfix">
		<!-- viewFramework-sidebar -->
		<div class="viewFramework-sidebar sidebar">
			<div class="sidebar-content">
				<div class="sidebar-inner">
				</div>
			</div>
		</div>

		<!-- viewFramework-product -->
		<div class="viewFramework-product" id="main_content">
			<!-- product navbar -->
			<div class="viewFramework-product-navbar">
				<div class="product-nav-stage product-nav-stage-main">
					<div class="product-nav-scene product-nav-main-scene">
					</div>
					<div class="product-nav-scene product-nav-sub-scene">
						<div class="product-nav-title"></div>
						<div class="product-nav-list">
							<ul></ul>
						</div>
					</div>
				</div>
			</div>
			<!-- /product navbar -->

			<!-- produck nav collapse -->
			<!--
			<div class="viewFramework-product-navbar-collapse">
				<div class="product-navbar-collapse-inner">
					<div class="product-navbar-collapse-bg"></div>
					<div class="product-navbar-collapse">
						<span class="icon-collapse-left"></span> 
						<span class="icon-collapse-right"></span>
					</div>
				</div>
			</div>
			-->
			<!-- /produck nav collapse -->
			<div class="viewFramework-product-body">
				<div class="product">
				</div>
			</div>
		</div>
	</div>
</div>
{% endblock %}

{% block bottom_script %}
<script type="text/javascript">
var app = app || {};
app.ui = {
	header_height: 70,
	box_title : 38,
	main_content_padding: [5, 8, 5, 8]
};
</script>

<script src="/static/admin/scripts/app.js"></script>

<script type="text/template" id="sidebar-template">
	<!--<div class="sidebar-fold W_ficon">S</div>-->
	<% _.each(e, function(item, index){ %>
	<div class="sidebar-nav">
		<% if (item.childs) { %>
		<div class="sidebar-title">
			<div class="sidebar-title-inner">
				<span class="sidebar-title-icon W_ficon">g</span><span class="sidebar-title-text"><%= item.menu_name %></span>
			</div>
		</div>
		<% } else { %>
		<ul class="sidebar-trans">
			<li class="nav-item" data-target="<%= item.menu_target %>" data-menu="<%= item.id %>" <% if (item.childs) { %>data-childs="1"<% } else { %>data-childs="0"<% } %>>
				<a class="sidebar-trans clearfix" href="<%= item.menu_url %>" target="frameCon" style="text-indent:2px;padding:10px 0px;">
					<span class="nav-title"><i class="glyphicon glyphicon-triangle-right" style="color:#46505c; font-size:11px;"></i>
					<span style="font-size: 13px;font-weight: 600;color: #46505c;"><%= item.menu_name %></span>
					</span>
				</a>
			</li>
		</ul>
		<% } %>

		<ul class="sidebar-trans">
			<% _.each(item.childs, function(item1, index1){ %>
			<li class="nav-item" data-target="<%= item1.menu_target %>" data-menu="<%= item1.id %>" <% if (item1.childs) { %>data-childs="1"<% } else { %>data-childs="0"<% } %>>
				<a class="sidebar-trans clearfix" href="<%= item1.menu_url %>" target="frameCon">
					<% if (item1.small_icon) { %>
					<div class="nav-icon sidebar-trans">
						<img src="/static/baseframe/img/nav/<%= item1.small_icon %>" alt="" />
					</div>
					<% } %>
					<span class="nav-title"><%= item1.menu_name %></span>
				</a>
			</li>
			<% }); %>
		</ul>
	</div>
	<% }); %>
</script>

<script type="text/template" id="product-template">
	<div class="product-content">
		<div class="container-fluid">
			<div class="row">
				<div class="col-md-6 product-feature">
					<h3 class="font-primary-bold product-title"><%= feature.title %></h3>
					<div class="feature-items">
						<ul class="clearfix">
							<% _.each(feature.items, function(item1, index) { %>
								<li><%= item1 %></li>
							<% }); %>
						</ul>
					</div>
				</div>
				<div class="col-md-6 product-list">
					<ul class="clearfix">
						<% _.each(lst, function(item1, index){ %>
							<li class="product-item" data-target="<%= item1.menu_target %>" data-menu="<%= item1.id %>" <% if (item1.childs) { %>data-childs="1"<% } else { %>data-childs="0"<% } %>>
								<a href="<%= item1.menu_url %>">
									<img class="product-item-iocn" alt="<%= item1.menu_name %>" src="/static/iconstore/60x60/<%= item1.big_icon %>">
									<span class="product-item-name"><%= item1.menu_name %></span>
								</a>
							</li>
						<% }); %>
					</ul>
				</div>
			</div>
		</div>
	</div>
</script>

<script type="text/template" id="product-nav-template">
	<div class="product-nav-title"><%= menuItem.menu_name %></div>
	<div class="ng-isolate-scope"></div>
	<div class="product-nav-list">
	    <ul>
	    	<% _.each(menuItem.childs, function(item, index) { %>
	    		<li class="product-nav-item<% if (menuItem.menu_url == item.menu_url) { %> active<% } %>" data-target="<%= item.menu_target %>" data-menu="<%= item.id %>" <% if (item.childs) { %>data-childs="1"<% } else { %>data-childs="0"<% } %>>
	                <a href="<%= item.menu_url %>" class="ng-scope">
	                    <div class="nav-icon"></div>
	                    <div class="nav-title"><%= item.menu_name %></div>
	                </a>
	        	</li>
			<% }); %>
	    </ul>
	</div>
</script>

<script type="text/template" id="product-full-template">
	<div class="product-content">
		<div class="product-title">
			<h3 class="font-primary-bold"><%= feature.title %></h3>
		</div>
		<div class="clearfix">
			<div class="product-summary">
				<p><%= feature.items %>.</p>
			</div>
			<div class="product-list">
				<ul class="clearfix">
					<% _.each(lst, function(item1, index1){ %>
						<% if (index1 < 4) { %>
							<li class="product-item" data-menu="<%= item1.id %>">
								<a href="<%= item1.menu_url %>">
									<img class="product-item-iocn" alt="<%= item1.menu_name %>" src="/static/iconstore/60x60/<%= item1.big_icon %>">
									<span class="product-item-name"><%= item1.menu_name %></span>
								</a>
							</li>
						<% } %>
					<% }); %>
				</ul>
			</div>
		</div>
		<div class="product-links clearfix">
			<% _.each(childs1, function(item, index){ %>
				<div class="linkItem">
					<div class="product-subtitle">
						<h6 class="font-primary-bold"><%= item.menu_name %></h6>
					</div>
					<ul class="clearfix">
						<% _.each(item.childs, function(item1, index1){ %>
							<li class="product-item" data-menu="<%= item1.id %>">
								<a href="<%= item1.menu_url %>">
									<span class="product-item-name"><%= item1.menu_name %></span>
								</a>
							</li>
						<% }); %>
					</ul>
				</div>
			<% }); %>
		</div>
	</div>
</script>

<script type="text/template" id="weather-template">
	<div class="weather-content">
		<img src="<%= day.dayPictureUrl %>" alt="天气" title="明天：<%= day1.weather %>&nbsp;<%= day1.temperature %>&#10;后天：<%= day1.weather %>&nbsp;<%= day2.temperature %>">&nbsp;<span><%= day.weather %></span>&nbsp;<span><%= day.temperature %></span>
	</div>
</script>

<script type="text/javascript">
	$(function(){
		app.menuData = {{ menusJson }};
		app.rootMenu = {{ menusJson }};
		app.views = app.views || {};
		app.views.dropdownView = app.views.dropdownView || new DropdownView();
		app.views.appView = app.views.appView || new AppView();
		app.views.topbarView = app.views.topbarView || new TopbarView();
		app.views.sidebarView = app.views.sidebarView || new SidebarView();
		app.views.productView = app.views.productView || new ProductView();
		app.views.menuView = app.views.menuView || new MenuView();
		// app.refresh = app.refresh || new app.refreshData();
		// app.refresh.rei_prjdbinf_count();
		// setInterval(app.refresh.rei_prjdbinf_count, 2000 * 60); 
		// app.weather = app.weather || new app.weatherData();
		// setTimeout(app.weather.refresh, 1000 * 5);
	});
</script>
{% endblock %}