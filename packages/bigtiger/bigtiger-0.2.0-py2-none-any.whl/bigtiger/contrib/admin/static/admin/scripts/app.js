var app=app||{};app.refreshData=function(){var e=null;return function(){e=$("#app-notice-num"),this.rei_prjdbinf_count=function(){}}}(),app.weatherData=function(){var e=null,t=null;return function(){e=$("#weather"),t=_.template($("#weather-template").html()),this.refresh=function(){$.get("/base/weather/",function(i){null!==i&&e.html(t({day:i.results[0].weather_data[0],day1:i.results[0].weather_data[1],day2:i.results[0].weather_data[2]}))})}}}(),app.mainWindow=function(){var e=null,t=null,i=function(){var i=$(window).height();if("function"==typeof e){var n=i-app.ui.header_height-app.ui.main_content_padding[0]-app.ui.main_content_padding[2]-app.ui.box_title;e(n)}if("function"==typeof t){var n=i-app.ui.header_height-app.ui.main_content_padding[0]-app.ui.main_content_padding[2];t(n)}};return new function(){$(window).resize(i),this.gridResize=function(t){e=t,i()},this.mainResize=function(e){t=e,i()},this.clear=function(){e=null,t=null}}}(),app.menus=function(){var e=function(t,i,n){for(var a=null,r=t.length-1;r>=0;r--){if(a=t[r],a.id===i)return a;if(a.depth!==n&&void 0!==a.childs){var s=e(a.childs,i,n);if(void 0!==s)return s}}};return new function(){this.getMenu=function(t,i){if(0===(i=i||1))return app.rootMenu;var n=app.rootMenu.childs;return e(n,t,i)}}}();var TopbarView=Backbone.View.extend({el:".topbar-nav-list",events:{"click li":"link"},initialize:function(){},render:function(){},link:function(e){e.preventDefault();var t,i,n,a,r;t=$(e.currentTarget),i=t.attr("data-menu"),n=t.attr("data-mainMenu"),a=t.children("a").attr("href"),r=app.menus.getMenu(n),app.views.menuView.setSelected(n),app.views.sidebarView.show(r.childs),app.views.sidebarView.setSelected(i),app.views.productView.link(a,r.menu_target)}}),MenuView=Backbone.View.extend({el:".header_nav",events:{"click li":"selected"},initialize:function(){this.$ifrInner=$("#ifrInner"),this.$lis=this.$("ul li"),this.render()},render:function(){var e=this.getSelected();return this.link(e),this},selected:function(e){e.preventDefault();var t=$(e.currentTarget),i=t.attr("data-menu");this.setSelected(i),this.link(i)},link:function(e){var t=app.menus.getMenu(e,1);null!==t&&(app.mainWindow.clear(),app.views.productView.hideNav(),void 0===t.childs?(app.views.sidebarView.hide(),app.views.productView.link(t.menu_url,t.menu_target)):(app.views.sidebarView.show(t.childs),app.views.productView.show(t)))},getSelected:function(){var e,t;return this.$lis.each(function(i,n){t=$(n),t.hasClass("selected")&&(e=t.attr("data-menu"))}),e},setSelected:function(e){this.$lis.each(function(t,i){$(i).attr("data-menu")!==e?$(i).removeClass("selected"):$(i).addClass("selected")})}}),SidebarView=Backbone.View.extend({el:".sidebar",events:{"click .sidebar-fold":"flod","click .sidebar-title":"navFlod","click .nav-item":"selected"},initialize:function(){this.$fold=this.$(".sidebar-fold"),this.$inner=this.$(".sidebar-inner"),this.$main=$(".viewFramework-body"),this.template=_.template($("#sidebar-template").html())},render:function(){return this},flod:function(e){this.$main.hasClass("viewFramework-sidebar-full")?(this.$main.removeClass("viewFramework-sidebar-full"),this.$main.addClass("viewFramework-sidebar-mini")):(this.$main.removeClass("viewFramework-sidebar-mini"),this.$main.addClass("viewFramework-sidebar-full")),window.hasOwnProperty("onMainWinResize")&&onMainWinResize()},navFlod:function(e){var t=$(e.currentTarget),i=t.parent(".sidebar-nav");i.hasClass("sidebar-nav-fold")?i.removeClass("sidebar-nav-fold"):i.addClass("sidebar-nav-fold")},selected:function(e){e.preventDefault();var t=$(e.currentTarget),i=t.attr("data-menu"),n=t.attr("data-target"),a=t.children("a").attr("href"),r=t.attr("data-childs");this.selected1(i,a,n,"1"===r)},selected1:function(e,t,i,n){if(n){var a=app.menus.getMenu(e,3);this.link(a)}else this.setSelected(e),this.linkUrl(t,i)},linkUrl:function(e,t){app.views.productView.hideNav(),app.views.productView.link(e,t)},link:function(e){this.setSelected(e.id),app.views.productView.showNav(e),app.views.productView.link(e.menu_url,e.menu_target)},show:function(e){this.$inner.html(this.template({e:e})),this.$main.hasClass("viewFramework-sidebar-none")&&(this.$main.removeClass("viewFramework-sidebar-none"),this.$main.addClass("viewFramework-sidebar-full"))},hide:function(){this.$main.removeClass("viewFramework-sidebar-full"),this.$main.removeClass("viewFramework-sidebar-mini"),this.$main.addClass("viewFramework-sidebar-none"),this.$inner.empty()},setSelected:function(e){this.$(".nav-item").each(function(t,i){$(i).attr("data-menu")!==e?$(i).removeClass("selected"):$(i).addClass("selected")})}}),ProductView=Backbone.View.extend({el:".viewFramework-product",events:{"click .product-item":"productSelect","click .product-nav-item":"selected","load #ifrInner":"ifrInnerLoaded"},initialize:function(){this.template=_.template($("#product-template").html()),this.navTemplate=_.template($("#product-nav-template").html()),this.$product=this.$(".product"),this.$mainNav=this.$(".product-nav-main-scene"),this.$subNav=this.$(".product-nav-sub-scene"),this.$ifrInner=this.$("#ifrInner"),this.iframe=document.getElementById("ifrInner")},selected:function(e){e.preventDefault();var t=$(e.currentTarget),i=t.attr("data-menu"),n=t.attr("data-target"),a=t.children("a").attr("href");t.attr("data-childs");this.link(a,n),this.setSelected(i)},setSelected:function(e){this.$(".product-nav-item").each(function(t,i){$(i).attr("data-menu")!==e?$(i).removeClass("active"):$(i).addClass("active")})},render:function(){},ifrInnerLoaded:function(){},productSelect:function(e){e.preventDefault();var t=$(e.currentTarget),i=t.attr("data-menu"),n=t.attr("data-target"),a=t.children("a").attr("href"),r=t.attr("data-childs");app.views.sidebarView.selected1(i,a,n,"1"===r)},link:function(e,t){var i=this.$product;"iframe"===t&&(e="/iframe/?url="+e),$.get(e,function(e){i.empty(),i.html(e)})},showNav:function(e){this.$mainNav.html(this.navTemplate({menuItem:e})),this.$el.hasClass("viewFramework-product-col-1")||this.$el.addClass("viewFramework-product-col-1")},hideNav:function(){this.$el.hasClass("viewFramework-product-col-1")&&this.$el.removeClass("viewFramework-product-col-1")},show:function(e){for(var t=[],i=e.childs,n=null,a=0,r=i.length;a<r;a++)if(void 0===i[a].childs)t.push(i[a]);else{n=i[a].childs;for(var s=0,l=n.length;s<l;s++)t.push(n[s])}var d=JSON.parse(e.remark);if(t.length<5)this.$product.html(this.template({e:e,lst:t,feature:d}));else{var t=_.filter(t,function(e){return 1==e.is_important});this.$product.html(this.template({e:e,lst:t,feature:d}))}this.$ifrInner.hide()},hide:function(){},full:function(){},large:function(){},small:function(){}}),AppView=Backbone.View.extend({el:"body",events:{},initialize:function(){},render:function(){return this}}),DropdownView=Backbone.View.extend({el:'[data-toggle="dropdown"]',events:{blur:"show",click:"hide"},initialize:function(){},render:function(){return this},show:function(e){e.preventDefault();var t=$(e.currentTarget).parent(".dropdown");setTimeout(function(){t.removeClass("open")},500)},hide:function(e){e.preventDefault(),$(e.currentTarget).parent(".dropdown").addClass("open")}});