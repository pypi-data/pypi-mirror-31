#!/usr/bin/env python3

import pathlib
import json
import argparse

from gandyndns import gandyndns

if __name__ == "__main__":
	parser = argparse.ArgumentParser()
	parser.add_argument('config', type=pathlib.Path, help='Path to gandyndns configuration file')
	parser.add_argument('--logging-level', type=int, help='Logging level')
	#parser.add_argument('--logging-handler', help='Logging handler')
	args = parser.parse_args()

	config = json.load(open(args.config))

	for domain in config.get('domains', {}):
		gandyndns_args = config['domains'][domain]
		if args.logging_level:
			gandyndns_args['logging_level'] = args.logging_level
		gandyndns(domain, **gandyndns_args)
