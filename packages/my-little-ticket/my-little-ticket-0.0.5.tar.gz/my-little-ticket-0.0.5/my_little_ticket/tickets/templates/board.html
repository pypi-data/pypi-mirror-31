{% extends 'base.html' %}
{% load bootstrap4 %}
{% load humanize %}

{% block title %}{{ board.name }}{% endblock %}


{% block content %}
    {% for group, tickets in groups %}
        <h3>{{ group }}</h3>
    <table class="table table-hover table-sm">
        <thead>
        <tr>
            <th>#</th>
            <th>Assignee</th>
            <th>Summary</th>
            <th>Age</th>
            <th>Score</th>
        </tr>
        </thead>
        <tbody>
        {% for ticket in tickets %}
            <tr>
                <td><a href="{{ ticket.link }}">{{ ticket.external_id }}</a></td>
                <td>{% if ticket.assignee %}{{ ticket.assignee|urlize }}{%  endif %}</td>
                <td>
                    <a href="{{ ticket.link }}">{{ ticket.summary }}</a><br/>
                    {% for tag in ticket.tags.all %}
                        <span class="badge badge-pill badge-info">{{ tag }}</span>
                    {% endfor %}
                </td>
                <td>
                    {{ ticket.created_on|naturaltime }}
                </td>
                <td>
                    <span class="badge badge-pill badge-{{ ticket.strategy_status }}">
                        {{ ticket.strategy_score|floatformat:"0" }} {# FIXME #}
                    </span>
                </td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
    {% endfor %}
    <div class="card">
        <h3 class="card-header">{{ board.name }}</h3>
        <div class="card-body">
            {{ board.description|urlize }}<br/>
            {{ board.link|urlize }}<br/>
            Strategy <strong>{{ board.strategy.name }}</strong>:
            {{ board.strategy.description|safe }}
        </div>
        <div class="card-footer">
            Sources:
            <ul>
                {% for source in board.sources.all %}
                    <li><a href="{{ source.link }}">{{ source }}</a> ({{ source.modified_on|naturaltime }})</li>
                {% endfor %}
            </ul>
        </div>
    </div>
{% endblock %}