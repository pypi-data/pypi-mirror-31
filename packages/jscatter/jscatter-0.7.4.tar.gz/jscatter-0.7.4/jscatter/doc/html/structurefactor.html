
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>7. structurefactor (sf) &#8212; jscatter 0.7.4 documentation</title>
    <link rel="stylesheet" href="_static//default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/Jscatter-32x-32.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="8. dynamic" href="dynamic.html" />
    <link rel="prev" title="6. formfactor (ff)" href="formfactor.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="dynamic.html" title="8. dynamic"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="formfactor.html" title="6. formfactor (ff)"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">jscatter 0.7.4 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="structurefactor-sf">
<h1>7. structurefactor (sf)<a class="headerlink" href="#structurefactor-sf" title="Permalink to this headline">¶</a></h1>
<p>Structure factors and directly related functions for scattering
related to interaction potentials between particles.</p>
<p>Return values are dataArrays were useful.</p>
<p>To get only Y values use .Y</p>
<p>For RMSA an improved algorithm is used based on the original idea (see Notes in RMSA).</p>
<div class="section" id="structure-factors">
<h2>7.1. Structure Factors<a class="headerlink" href="#structure-factors" title="Permalink to this headline">¶</a></h2>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.structurefactor.RMSA" title="jscatter.structurefactor.RMSA"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RMSA</span></code></a>(q,&nbsp;R,&nbsp;scl,&nbsp;gamma[,&nbsp;molarity,&nbsp;eta,&nbsp;useHP])</td>
<td>Structure factor for a screened coulomb interaction in rescaled mean spherical approximation (RMSA).</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.structurefactor.PercusYevick" title="jscatter.structurefactor.PercusYevick"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PercusYevick</span></code></a>(q,&nbsp;R[,&nbsp;molarity,&nbsp;eta])</td>
<td>The Percus-Yevick structure factor.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.structurefactor.PercusYevick1D" title="jscatter.structurefactor.PercusYevick1D"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PercusYevick1D</span></code></a>(q[,&nbsp;R,&nbsp;eta])</td>
<td>The PercusYevick structure factor in 1D</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.structurefactor.PercusYevick2D" title="jscatter.structurefactor.PercusYevick2D"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PercusYevick2D</span></code></a>(q[,&nbsp;R,&nbsp;eta,&nbsp;a])</td>
<td>The PercusYevick structure factor in 2D</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.structurefactor.stickyHardSphere" title="jscatter.structurefactor.stickyHardSphere"><code class="xref py py-obj docutils literal notranslate"><span class="pre">stickyHardSphere</span></code></a>(q,&nbsp;R,&nbsp;width,&nbsp;depth[,&nbsp;…])</td>
<td>Structure factor of a square well potential with depth and width (sticky hard spheres).</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.structurefactor.adhesiveHardSphere" title="jscatter.structurefactor.adhesiveHardSphere"><code class="xref py py-obj docutils literal notranslate"><span class="pre">adhesiveHardSphere</span></code></a>(q,&nbsp;R,&nbsp;tau,&nbsp;delta[,&nbsp;…])</td>
<td>structure factor of a adhesive hard sphere potential (a square well potential)</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.structurefactor.criticalSystem" title="jscatter.structurefactor.criticalSystem"><code class="xref py py-obj docutils literal notranslate"><span class="pre">criticalSystem</span></code></a>(q,&nbsp;corrlength,&nbsp;isothermalcompress)</td>
<td>Structure factor of a critical system should take the Ornstein-Zernike form.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.structurefactor.latticeStructureFactor" title="jscatter.structurefactor.latticeStructureFactor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">latticeStructureFactor</span></code></a>(q[,&nbsp;lattice,&nbsp;…])</td>
<td>Radial structure factor S(q) of a crystal lattice with particle asymmetry, DebyeWaller factor, diffusive scattering and domain size.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.structurefactor.latticeStructureFactor2D" title="jscatter.structurefactor.latticeStructureFactor2D"><code class="xref py py-obj docutils literal notranslate"><span class="pre">latticeStructureFactor2D</span></code></a>(qxyz,&nbsp;lattice[,&nbsp;…])</td>
<td>2D structure factor S(q) of a crystal lattice including particle asymmetry, DebyeWaller factor, diffusive scattering, rotation and domain size.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="hydrodynamics">
<h2>7.2. Hydrodynamics<a class="headerlink" href="#hydrodynamics" title="Permalink to this headline">¶</a></h2>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.structurefactor.hydrodynamicFunct" title="jscatter.structurefactor.hydrodynamicFunct"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hydrodynamicFunct</span></code></a>(wavevector,&nbsp;Rh,&nbsp;molarity)</td>
<td>Hydrodynamic function H(Q) from hydrodynamic pair interaction of spheres in suspension.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="pair-correlation">
<h2>7.3. Pair Correlation<a class="headerlink" href="#pair-correlation" title="Permalink to this headline">¶</a></h2>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.structurefactor.sq2gr" title="jscatter.structurefactor.sq2gr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sq2gr</span></code></a>(Sq,&nbsp;R[,&nbsp;interpolatefactor])</td>
<td>Radial distribution function g(r) from structure factor Sq.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="lattice">
<h2>7.4. Lattice<a class="headerlink" href="#lattice" title="Permalink to this headline">¶</a></h2>
<p><strong>Lattices with specific structure</strong> :</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.structurefactor.bravaisLattice" title="jscatter.structurefactor.bravaisLattice"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bravaisLattice</span></code></a>(latticeVectors,&nbsp;size)</td>
<td>Create a bravais lattice.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.structurefactor.scLattice" title="jscatter.structurefactor.scLattice"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scLattice</span></code></a>(abc,&nbsp;size)</td>
<td>Simple Cubic lattice.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.structurefactor.bccLattice" title="jscatter.structurefactor.bccLattice"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bccLattice</span></code></a>(abc,&nbsp;size[,&nbsp;b])</td>
<td>Body centered cubic lattice.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.structurefactor.fccLattice" title="jscatter.structurefactor.fccLattice"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fccLattice</span></code></a>(abc,&nbsp;size)</td>
<td>Face centered cubic lattice.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.structurefactor.hexLattice" title="jscatter.structurefactor.hexLattice"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hexLattice</span></code></a>(ab,&nbsp;size)</td>
<td>Simple 2D hexagonal lattice.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.structurefactor.hcpLattice" title="jscatter.structurefactor.hcpLattice"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hcpLattice</span></code></a>(ab,&nbsp;size)</td>
<td>Hexagonal closed packed lattice.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.structurefactor.diamondLattice" title="jscatter.structurefactor.diamondLattice"><code class="xref py py-obj docutils literal notranslate"><span class="pre">diamondLattice</span></code></a>(abc,&nbsp;size)</td>
<td>Diamond cubic lattice with 8 atoms in unit cell.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.structurefactor.rhombicLattice" title="jscatter.structurefactor.rhombicLattice"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rhombicLattice</span></code></a>(latticeVectors,&nbsp;size[,&nbsp;…])</td>
<td>Create a rhombic lattice with specified unit cell atoms.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.structurefactor.pseudoRandomLattice" title="jscatter.structurefactor.pseudoRandomLattice"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pseudoRandomLattice</span></code></a>(size,&nbsp;numberOfPoints[,&nbsp;…])</td>
<td>Create a  lattice with a pseudo random distribution of points.</td>
</tr>
</tbody>
</table>
<p><strong>lattice methods</strong> :</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.structurefactor.lattice.X" title="jscatter.structurefactor.lattice.X"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lattice.X</span></code></a></td>
<td>X coordinates</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.structurefactor.lattice.Y" title="jscatter.structurefactor.lattice.Y"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lattice.Y</span></code></a></td>
<td>Y coordinates</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.structurefactor.lattice.Z" title="jscatter.structurefactor.lattice.Z"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lattice.Z</span></code></a></td>
<td>Z coordinates</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.structurefactor.lattice.b" title="jscatter.structurefactor.lattice.b"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lattice.b</span></code></a></td>
<td>Scattering length</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.structurefactor.lattice.filter" title="jscatter.structurefactor.lattice.filter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lattice.filter</span></code></a>(funktion)</td>
<td>Filter lattice points according to a function.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.structurefactor.lattice.centerOfMass" title="jscatter.structurefactor.lattice.centerOfMass"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lattice.centerOfMass</span></code></a>()</td>
<td>CenterOf mass</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.structurefactor.lattice.numberOfAtoms" title="jscatter.structurefactor.lattice.numberOfAtoms"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lattice.numberOfAtoms</span></code></a>()</td>
<td>Number of Atoms</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.structurefactor.lattice.planeSide" title="jscatter.structurefactor.lattice.planeSide"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lattice.planeSide</span></code></a>(vector[,&nbsp;invert])</td>
<td>Select points on one side of a plane.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.structurefactor.lattice.move" title="jscatter.structurefactor.lattice.move"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lattice.move</span></code></a>(vector)</td>
<td>Move all points by vector.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.structurefactor.lattice.inSphere" title="jscatter.structurefactor.lattice.inSphere"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lattice.inSphere</span></code></a>(R)</td>
<td>Choose lattice points in sphere</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.structurefactor.lattice.show" title="jscatter.structurefactor.lattice.show"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lattice.show</span></code></a>([R])</td>
<td>Show the lattice in matplotlib.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.structurefactor.lattice.limit2Cube" title="jscatter.structurefactor.lattice.limit2Cube"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lattice.limit2Cube</span></code></a>(a,&nbsp;b,&nbsp;c)</td>
<td>Cut at cube with edges at</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.structurefactor.rhombicLattice.unitCellAtomPositions" title="jscatter.structurefactor.rhombicLattice.unitCellAtomPositions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rhombicLattice.unitCellAtomPositions</span></code></a></td>
<td>Absolute positions of unit cell atoms.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.structurefactor.rhombicLattice.getReciprocalLattice" title="jscatter.structurefactor.rhombicLattice.getReciprocalLattice"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rhombicLattice.getReciprocalLattice</span></code></a>([size])</td>
<td>Reciprocal lattice of given size with peak scattering intensity.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.structurefactor.rhombicLattice.getRadialReciprocalLattice" title="jscatter.structurefactor.rhombicLattice.getRadialReciprocalLattice"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rhombicLattice.getRadialReciprocalLattice</span></code></a>(size)</td>
<td>Get radial distribution of Bragg peaks with structure factor and multiplicity.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.structurefactor.rhombicLattice.rotate2hkl" title="jscatter.structurefactor.rhombicLattice.rotate2hkl"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rhombicLattice.rotate2hkl</span></code></a>(grid,&nbsp;h,&nbsp;k,&nbsp;l)</td>
<td>Rotate a grid to a plane perpendicular to hkl direction.</td>
</tr>
</tbody>
</table>
<p>Lattice objects describing a lattice of points.</p>
<p>Included are methods to select sublattices as cubes, sphere or side of planes.</p>
<p>The small angle scattering can is calculated by js.ff.cloudScattering.</p>
<p>The same method can be used to calculate the wide angle scattering with bragg peaks
using larger scattering vectors.</p>
<p><strong>Examples</strong></p>
<p>A hollow sphere cut to a wedge.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jscatter</span> <span class="k">as</span> <span class="nn">js</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">grid</span><span class="o">=</span> <span class="n">js</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">scLattice</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="mi">8</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">inSphere</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">inSphere</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">limit2Cube</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">planeSide</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">grid</span><span class="o">.</span><span class="n">planeSide</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">grid</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">q</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">loglist</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">600</span><span class="p">)</span>
<span class="n">ffe</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">ff</span><span class="o">.</span><span class="n">cloudScattering</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">grid</span><span class="o">.</span><span class="n">points</span><span class="p">,</span><span class="n">relError</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span><span class="n">rms</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">p</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">grace</span><span class="p">()</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ffe</span><span class="p">)</span>
</pre></div>
</div>
<p>A comparison of sc, bcc and fcc nanoparticles (takes a while )</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jscatter</span> <span class="k">as</span> <span class="nn">js</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">q</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">loglist</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">1500</span><span class="p">)</span>
<span class="n">q</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">js</span><span class="o">.</span><span class="n">loglist</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">200</span><span class="p">),</span><span class="mi">3</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mi">800</span><span class="n">j</span><span class="p">]</span>
<span class="n">unitcelllength</span><span class="o">=</span><span class="mf">1.5</span>
<span class="n">N</span><span class="o">=</span><span class="mi">8</span>

<span class="n">scgrid</span><span class="o">=</span> <span class="n">js</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">scLattice</span><span class="p">(</span><span class="n">unitcelllength</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">sc</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">ff</span><span class="o">.</span><span class="n">cloudScattering</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">scgrid</span><span class="o">.</span><span class="n">points</span><span class="p">,</span><span class="n">relError</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">rms</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">bccgrid</span><span class="o">=</span> <span class="n">js</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">bccLattice</span><span class="p">(</span><span class="n">unitcelllength</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">bcc</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">ff</span><span class="o">.</span><span class="n">cloudScattering</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">bccgrid</span><span class="o">.</span><span class="n">points</span><span class="p">,</span><span class="n">relError</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">rms</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">fccgrid</span><span class="o">=</span> <span class="n">js</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">fccLattice</span><span class="p">(</span><span class="n">unitcelllength</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">fcc</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">ff</span><span class="o">.</span><span class="n">cloudScattering</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">fccgrid</span><span class="o">.</span><span class="n">points</span><span class="p">,</span><span class="n">relError</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">rms</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>

<span class="n">p</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">grace</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># smooth with Gaussian to include instrument resolution</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sc</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="n">js</span><span class="o">.</span><span class="n">formel</span><span class="o">.</span><span class="n">smooth</span><span class="p">(</span><span class="n">sc</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;gaussian&#39;</span><span class="p">),</span><span class="n">legend</span><span class="o">=</span><span class="s1">&#39;sc&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bcc</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="n">js</span><span class="o">.</span><span class="n">formel</span><span class="o">.</span><span class="n">smooth</span><span class="p">(</span><span class="n">bcc</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;gaussian&#39;</span><span class="p">),</span><span class="n">legend</span><span class="o">=</span><span class="s1">&#39;bcc&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fcc</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="n">js</span><span class="o">.</span><span class="n">formel</span><span class="o">.</span><span class="n">smooth</span><span class="p">(</span><span class="n">fcc</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;gaussian&#39;</span><span class="p">),</span><span class="n">legend</span><span class="o">=</span><span class="s1">&#39;fcc&#39;</span><span class="p">)</span>

<span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">loglist</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">q</span><span class="p">,(</span><span class="mi">1</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">q</span><span class="o">*</span><span class="n">q</span><span class="o">*</span><span class="mf">0.05</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="n">scgrid</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">li</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">sy</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">le</span><span class="o">=</span><span class="s1">&#39;sc diffusive&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">q</span><span class="p">,(</span><span class="mi">1</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">q</span><span class="o">*</span><span class="n">q</span><span class="o">*</span><span class="mf">0.05</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="n">bccgrid</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">li</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">sy</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">le</span><span class="o">=</span><span class="s1">&#39;bcc diffusive&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">q</span><span class="p">,(</span><span class="mi">1</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">q</span><span class="o">*</span><span class="n">q</span><span class="o">*</span><span class="mf">0.05</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="n">fccgrid</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">li</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">sy</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">le</span><span class="o">=</span><span class="s1">&#39;fcc diffusive&#39;</span><span class="p">)</span>

<span class="n">p</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Comparison sc, bcc, fcc lattice for a nano cube&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">yaxis</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;I(Q)&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">xaxis</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Q / A\S-1&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span><span class="n">charsize</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="s1">&#39;cube formfactor&#39;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span><span class="n">charsize</span><span class="o">=</span><span class="mf">1.4</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="s1">&#39;Bragg peaks&#39;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span><span class="n">charsize</span><span class="o">=</span><span class="mf">1.4</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="s1">&#39;diffusive scattering&#39;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span><span class="n">charsize</span><span class="o">=</span><span class="mf">1.4</span><span class="p">)</span>
</pre></div>
</div>
<hr class="docutils" />
<span class="target" id="module-jscatter.structurefactor"></span><p>Structure factors and directly related functions for scattering
related to interaction potentials between particles.</p>
<p>Return values are dataArrays were useful.</p>
<p>To get only Y values use .Y</p>
<p>For RMSA an improved algorithm is used based on the original idea (see Notes in RMSA).</p>
<dl class="function">
<dt id="jscatter.structurefactor.PercusYevick">
<code class="descclassname">jscatter.structurefactor.</code><code class="descname">PercusYevick</code><span class="sig-paren">(</span><em>q</em>, <em>R</em>, <em>molarity=None</em>, <em>eta=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/structurefactor.html#PercusYevick"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.PercusYevick" title="Permalink to this definition">¶</a></dt>
<dd><p>The Percus-Yevick structure factor.</p>
<p>Structure factor for the potential U(r)= (inf for 0&lt;r&lt;R) and (0 for R&lt;r).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>q</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array; N dim</span></dt>
<dd><p class="first last">scattering vector; units 1/(R[unit])</p>
</dd>
<dt><strong>R</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Radius of the object</p>
</dd>
<dt><strong>eta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">volume fraction as eta=4/3*pi*R**3*n  with number density n in units or R</p>
</dd>
<dt><strong>molarity</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">number density in mol/l and defines q and R units to 1/nm and nm to be correct 
preferred over eta if both given</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>dataArray</strong></dt>
<dd><p class="first last">structure factor for given q</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Problem is given in <a class="reference internal" href="#rf737b691f95c-1" id="id1">[1]</a>; solution in <a class="reference internal" href="#rf737b691f95c-2" id="id2">[2]</a> and best description of the solution is in <a class="reference internal" href="#rf737b691f95c-3" id="id3">[3]</a>.</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="rf737b691f95c-1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id4">2</a>)</em> <ol class="last upperalpha simple" start="10">
<li><ol class="first upperalpha" start="11">
<li>Percus and G. J. Yevick, Phys. Rev. 110, 1 (1958).</li>
</ol>
</li>
</ol>
</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="rf737b691f95c-2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[2]</td><td><em>(<a class="fn-backref" href="#id2">1</a>, <a class="fn-backref" href="#id5">2</a>)</em> <ol class="last upperalpha simple" start="13">
<li><ol class="first upperalpha" start="19">
<li>Wertheim, Phys. Rev. Lett. 10, 321 (1963).</li>
</ol>
</li>
</ol>
</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="rf737b691f95c-3" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[3]</td><td><em>(<a class="fn-backref" href="#id3">1</a>, <a class="fn-backref" href="#id6">2</a>)</em> <ol class="last upperalpha simple" start="4">
<li><ol class="first upperalpha" start="10">
<li>Kinning and E. L. Thomas, Macromolecules 17, 1712 (1984).</li>
</ol>
</li>
</ol>
</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jscatter.structurefactor.PercusYevick1D">
<code class="descclassname">jscatter.structurefactor.</code><code class="descname">PercusYevick1D</code><span class="sig-paren">(</span><em>q</em>, <em>R=1</em>, <em>eta=0.1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/structurefactor.html#PercusYevick1D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.PercusYevick1D" title="Permalink to this definition">¶</a></dt>
<dd><p>The PercusYevick structure factor in 1D</p>
<p>Structure factor for the potential U(r)= (inf for 0&lt;r&lt;R) and (0 for R&lt;r).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>q</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array; N dim</span></dt>
<dd><p class="first last">scattering vector; units 1/(R[unit])</p>
</dd>
<dt><strong>R</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Radius of the object</p>
</dd>
<dt><strong>eta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">packing fraction as eta=2*R*n  with number density n</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>dataArray</strong></dt>
<dd></dd>
<dt><strong>[q,structure factor]</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<table class="docutils citation" frame="void" id="r1fa928aad5fb-1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>Exact solution of the Percus-Yevick equation for a hard-core fluid in odd dimensions
Leutheusser E  Physica A 1984 vol: 127 (3) pp: 667-676</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r1fa928aad5fb-2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[2]</td><td>On the equivalence of the Ornstein–Zernike relation and Baxter’s relations for a one-dimensional simple fluid
Chen M Journal of Mathematical Physics 1975 vol: 16 (5) pp: 1150</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jscatter.structurefactor.PercusYevick2D">
<code class="descclassname">jscatter.structurefactor.</code><code class="descname">PercusYevick2D</code><span class="sig-paren">(</span><em>q</em>, <em>R=1</em>, <em>eta=0.1</em>, <em>a=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/structurefactor.html#PercusYevick2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.PercusYevick2D" title="Permalink to this definition">¶</a></dt>
<dd><p>The PercusYevick structure factor in 2D</p>
<p>Structure factor for the potential U(r)= (inf for 0&lt;r&lt;R) and (0 for R&lt;r).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>q</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array; N dim</span></dt>
<dd><p class="first last">scattering vector; units 1/(R[unit])</p>
</dd>
<dt><strong>R</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, default 1</span></dt>
<dd><p class="first last">Radius of the object</p>
</dd>
<dt><strong>eta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, default 0.1</span></dt>
<dd><p class="first last">packing fraction as eta=pi*R**2*n  with number density n
maximum hexagonal closed = (np.pi*R**2)/(3/2.*3**0.5*a**2)
Rmax=a*3**0.5/2. with max packing of 0.9069</p>
</dd>
<dt><strong>a</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, default None</span></dt>
<dd><p class="first last">hexagonal lattice constant
if not None the packing fraction in hexagonal lattice
as eta=(np.pi*R**2)/(3/2.*3**0.5*a**2) is used</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>dataArary</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r73ca65adeb73-1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id7">[1]</a></td><td>Free-energy model for the inhomogeneous hard-sphere fluid in D dimensions:
Structure factors for the hard-disk (D=2) mixtures in simple explicit form
Yaakov Rosenfeld Phys. Rev. A 42, 5978</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jscatter.structurefactor.RMSA">
<code class="descclassname">jscatter.structurefactor.</code><code class="descname">RMSA</code><span class="sig-paren">(</span><em>q</em>, <em>R</em>, <em>scl</em>, <em>gamma</em>, <em>molarity=None</em>, <em>eta=None</em>, <em>useHP=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/structurefactor.html#RMSA"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.RMSA" title="Permalink to this definition">¶</a></dt>
<dd><p>Structure factor for a screened coulomb interaction in rescaled mean spherical approximation (RMSA).</p>
<p>Structure factor according to Hayter-Penfold <a class="reference internal" href="#rb696f496a7a7-1" id="id8">[1]</a> <a class="reference internal" href="#rb696f496a7a7-2" id="id9">[2]</a> .
Consider a scattering system consisting of macro ions, counter ions  and solvent.
Here an improved algorithm is used based on the original idea described in <a class="reference internal" href="#rb696f496a7a7-1" id="id10">[1]</a> (see Notes).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>q</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array; N dim</span></dt>
<dd><p class="first last">Scattering vector; units 1/nm</p>
</dd>
<dt><strong>R</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Radius of the object; units nm</p>
</dd>
<dt><strong>molarity</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Number density n in units mol/l. Overides eta, if both given.</p>
</dd>
<dt><strong>scl</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float&gt;0</span></dt>
<dd><p class="first last">Screening length; units nm; negative values evaluate to scl=0.</p>
</dd>
<dt><strong>gamma</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><div class="first last line-block">
<div class="line">contact potential; units kT</div>
<div class="line">gamma=Zm/(pi*e0*e*R*(2+k*R))</div>
<div class="line-block">
<div class="line">Zm = Z* effective surface charge</div>
<div class="line">e0,e free permittivity and dielectric constant</div>
<div class="line">k=1/scl inverse screening length of Debye-Hückel potential</div>
</div>
</div>
</dd>
<dt><strong>eta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Volume fraction as eta=4/3*pi*R**3*n  with number density n.</p>
</dd>
<dt><strong>useHP</strong> <span class="classifier-delimiter">:</span> <span class="classifier">True, default False</span></dt>
<dd><p class="first last">To use the original Hayter/Penfold algorithm. This gives wrong results for some parameter conditions.
It should ONLY be used for testing.
See example examples/test_newRMSAAlgorithm.py for a direct comparison.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>dataArray</strong> <span class="classifier-delimiter">:</span> <span class="classifier">.</span></dt>
<dd><ul class="first last simple">
<li>.volumeFraction = eta</li>
<li>.rescaledVolumeFraction</li>
<li>.screeningLength</li>
<li>.gamma=gamma</li>
<li>.contactpotential</li>
<li>.S0 structure factor at q=0</li>
<li>.scalingfactor factor for rescaling to get g+1=0; if =1 nothing was scaled and it is MSA</li>
</ul>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<dl class="docutils">
<dt>Improved algorithm</dt>
<dd>The Python code is deduced from the original Hayter-Penfold Fortran code (1981, ILL Grenoble).
This is also used in other common SAS programs as SASfit or SASview (translated to C).
The original algorithm determines the root of a quartic F(w1,w2,w3,w4) by an estimate (named PW estimate),
refining it by a Newton algorithm. As the PW estimate is somtimes not good enough this results in an
arbitrary root of the quartic in the Newton algorithm. The solution therefore jumps between different
posibilities by small changes of the parameters.
We use here the original idea from <a class="reference internal" href="#rb696f496a7a7-1" id="id11">[1]</a> to calculate G(r&lt;0) for all four roots of F(w1,w2,w3,w4) and use
the physical solution with G(r&lt;R)=0.
See examples/test_newRMSAAlgorithm.py for a direct comparison.</dd>
<dt>Validity</dt>
<dd>The calculation of charge at the surface or screening length from a solute ion concentration is explicitly dedicate
to the user. The Debye-Hückel theory for a macro ion in screened solution is a far field theory as a linearization
of the Poisson-Boltzmann (PB) theory and from limited validity (far field or low charge -&gt; linearization).
Things like reverting charge layer, ion condensation at the surface, pH changes at the surface or other things
might appear. Before calculating please take these things into account. Close to the surface the PB has to be solved.
The DH theory can still be used if the charge is thus an effective charge named Z*, which might be different from the
real surface charge.
See Ref <a class="reference internal" href="#rb696f496a7a7-3" id="id12">[3]</a> for details.</dd>
</dl>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="rb696f496a7a7-1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td><em>(<a class="fn-backref" href="#id8">1</a>, <a class="fn-backref" href="#id10">2</a>, <a class="fn-backref" href="#id11">3</a>, <a class="fn-backref" href="#id13">4</a>)</em> <ol class="last upperalpha simple" start="10">
<li><ol class="first upperalpha" start="2">
<li>Hayter and J. Penfold, Mol. Phys. 42, 109 (1981).</li>
</ol>
</li>
</ol>
</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="rb696f496a7a7-2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[2]</td><td><em>(<a class="fn-backref" href="#id9">1</a>, <a class="fn-backref" href="#id14">2</a>)</em> J.-P. Hansen and J. B. Hayter, Mol. Phys. 46, 651 (2006).</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="rb696f496a7a7-3" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[3]</td><td><em>(<a class="fn-backref" href="#id12">1</a>, <a class="fn-backref" href="#id15">2</a>)</em> <ol class="last upperalpha simple" start="12">
<li>Belloni, J. Phys. Condens. Matter 12, R549 (2000).</li>
</ol>
</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jscatter.structurefactor.adhesiveHardSphere">
<code class="descclassname">jscatter.structurefactor.</code><code class="descname">adhesiveHardSphere</code><span class="sig-paren">(</span><em>q</em>, <em>R</em>, <em>tau</em>, <em>delta</em>, <em>molarity=None</em>, <em>eta=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/structurefactor.html#adhesiveHardSphere"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.adhesiveHardSphere" title="Permalink to this definition">¶</a></dt>
<dd><p>structure factor of a adhesive hard sphere potential (a square well potential)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>q</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array; N dim</span></dt>
<dd><p class="first last">scattering vector; units 1/(R[unit])</p>
</dd>
<dt><strong>R</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">radius of the hard core</p>
</dd>
<dt><strong>eta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">volume fraction of the hard core particles</p>
</dd>
<dt><strong>molarity</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">number density in mol/l and defines q and R units to 1/nm and nm to be correct
preferred over eta if both given</p>
</dd>
<dt><strong>tau</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">stickiness</p>
</dd>
<dt><strong>delta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">width of the square well</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The potential U(r) is defined as 
r&lt;2R             U(r)=infinity
2R&lt;r&lt;2R+delta    U(r)=-depth=ln(12*tau*delta/(2R+delta))   
r &gt;2R+delta      U(r)=0</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="rc8e69d166c1a-1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id16">[1]</a></td><td><ol class="first last upperalpha simple" start="3">
<li>Regnaut and J. C. Ravey, J. Chem. Phys. 91, 1211 (1989).</li>
</ol>
</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="rc8e69d166c1a-2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id17">[2]</a></td><td><ol class="first last upperalpha simple" start="3">
<li>Regnaut and J. C. Ravey, J. Chem. Phys. 92 (5) (1990), 3250 Erratum</li>
</ol>
</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jscatter.structurefactor.criticalSystem">
<code class="descclassname">jscatter.structurefactor.</code><code class="descname">criticalSystem</code><span class="sig-paren">(</span><em>q</em>, <em>corrlength</em>, <em>isothermalcompress</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/structurefactor.html#criticalSystem"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.criticalSystem" title="Permalink to this definition">¶</a></dt>
<dd><p>Structure factor of a critical system should take the Ornstein-Zernike form.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>q</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array; N dim</span></dt>
<dd><p class="first last">scattering vector; units 1/(R[unit])</p>
</dd>
<dt><strong>corrlength</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">correlation length</p>
</dd>
<dt><strong>isothermalcompress</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">isothermal compressibility of the system</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The peaking of the structure factor near Q=0 region is due to attractive interaction.
Away from it the structure factor should be close to the hard sphere structure factor.
Near the critical point we should find 
S(Q)=S_PY(Q)+S_OZ(Q)
S_PY Percus Yevik structure factor
S_OZ this function</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r30d448b57a27-1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id18">[1]</a></td><td>Analysis of Critical Scattering Data from AOT/D2O/n-Decane Microemulsions
S. H. Chen, T. L. Lin, M. Kotlarchyk
Surfactants in Solution pp 1315-1330</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jscatter.structurefactor.hydrodynamicFunct">
<code class="descclassname">jscatter.structurefactor.</code><code class="descname">hydrodynamicFunct</code><span class="sig-paren">(</span><em>wavevector</em>, <em>Rh</em>, <em>molarity</em>, <em>intrinsicVisc=None</em>, <em>DsoverD0=None</em>, <em>structureFactor=None</em>, <em>structureFactorArgs={}</em>, <em>numberOfPoints=50</em>, <em>ncpu=-1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/structurefactor.html#hydrodynamicFunct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.hydrodynamicFunct" title="Permalink to this definition">¶</a></dt>
<dd><p>Hydrodynamic function H(Q) from hydrodynamic pair interaction of spheres in suspension.</p>
<p>We use the theory from Beenakker and Mazur <a class="reference internal" href="#r067a00e66dac-2" id="id19">[2]</a> as given by Genz <a class="reference internal" href="#r067a00e66dac-1" id="id20">[1]</a>.
The <span class="math">\delta\gamma</span>-expansion of Beenakker expresses many body hydrodynamic 
interaction within the renormalization approach dependent on the structure factor S(q).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>wavevector</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array</span></dt>
<dd><p class="first last">scattering vector q in units 1/nm</p>
</dd>
<dt><strong>Rh</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">effective hydrodynamic radius of particles in nm.</p>
</dd>
<dt><strong>molarity</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><div class="first last line-block">
<div class="line">molarity in mol/l</div>
<div class="line">This overides a parameter ‘molarity’ in the structureFactorArgs.</div>
<div class="line">Rh and molarity define the hydrodynamic interaction, the volume fraction and Ds/D0 for H(Q).</div>
<div class="line">The structure factor may have a radius different from Rh e.g. for attenuated hydrodynamic interactions.</div>
</div>
</dd>
<dt><strong>DsoverD0</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><div class="first last line-block">
<div class="line">The high Q limit of the hydrodynamic function is for low volume fractions</div>
<div class="line">Ds/D0= 1/(1+intrinsicVisc * volumeFraction ) with self diffusion Ds.</div>
<div class="line">Ds is calculated from molarity and Rh.</div>
<div class="line">This explicit value overrides intrinsic viscosity and calculated Ds/D0.</div>
</div>
</dd>
<dt><strong>structureFactor</strong> <span class="classifier-delimiter">:</span> <span class="classifier">function, None</span></dt>
<dd><div class="first last line-block">
<div class="line">Structure factor S(q) with S(q=inf)=1.0 recommended.</div>
<div class="line">1: If structurefactor is None a Percus-Yevik is assumed with molarity and R=Rh.</div>
<div class="line">2: A function S(q,…) is given as structure factor, which might be an</div>
<div class="line-block">
<div class="line">empirical function (e.g. polynominal fit of a measurement)</div>
<div class="line">First parameter needs to be wavevector q .</div>
<div class="line">If “molarity” parameter is present it is overwriten by molarity above.</div>
</div>
</div>
</dd>
<dt><strong>structureFactorArgs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dictionary</span></dt>
<dd><p class="first last">Any extra arguments to structureFactor e.g. structFactorArgs={‘x’:0.123,R=3,….}</p>
</dd>
<dt><strong>intrinsicVisc</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><div class="first last line-block">
<div class="line">Defines the high q limit for the hydrodynamic function.</div>
<div class="line">effective_viscosity= eta_solvent * (1-intrinsicVisc*Volumefraction )</div>
<div class="line">intrinsicVisc = 2.5 Einstein hard sphere density 1 g/cm**3</div>
<div class="line">For proteins instead of volume fraction  the protein concentration in g/ml with typical</div>
<div class="line">protein density 1.37 g/cm^3 is often used.</div>
<div class="line">Intrinsic Viscosity depends on protein shape (see HYDROPRO).</div>
<div class="line">Typical real values for intrinsicVisc in practical units cm^3/g</div>
<div class="line-block">
<div class="line">sphere 1.76 cm^3/g= 2.5    sphere with protein density</div>
<div class="line">ADH    3.9        = 5.5    a tetrameric protein</div>
<div class="line">PGK    4.0        = 5.68   two domains with hinge-&gt; elongated</div>
<div class="line">Rnase  3.2        = 4.54   one domain</div>
</div>
<div class="line">eta_solvent/effective_viscosity = (1-intrinsicVisc * Volumefraction )=Dself/D0</div>
</div>
</dd>
<dt><strong>numberOfPoints</strong> <span class="classifier-delimiter">:</span> <span class="classifier">integer, default 50</span></dt>
<dd><p class="first last">Determines number of integration points in equ 5 of ref <a class="reference internal" href="#r067a00e66dac-1" id="id21">[1]</a> and therfore accuracy of integration.
The typical accuracy of this function is &lt;1e-4 for (H(q) -highQLimit) and &lt;1e-3 for Ds/D0.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>dataArray</strong></dt>
<dd><div class="first last line-block">
<div class="line">[0] q values</div>
<div class="line">[1] hydrodynamic function</div>
<div class="line">[2] hydrodynamic function only Q dependent part = H(q) -highQLimit</div>
<div class="line">[3] structure factor for H(q) calculation</div>
<div class="line">.selfdiffusion Ds</div>
</div>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Ds is calculated according to equ 11 in <a class="reference internal" href="#r067a00e66dac-1" id="id22">[1]</a> which is valid for volume fractions up to 0.5.
With this assumption the deviation of self diffusion Ds from 
Ds=Do*[1-1.73*phi+0.88*phi**2+ O(phi**3)] is smaller 5% for phi&lt;0.2 (10% for phi&lt;0.3)</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r067a00e66dac-1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td><em>(<a class="fn-backref" href="#id20">1</a>, <a class="fn-backref" href="#id21">2</a>, <a class="fn-backref" href="#id22">3</a>, <a class="fn-backref" href="#id23">4</a>)</em> <ol class="last upperalpha simple" start="21">
<li>Genz and R. Klein, Phys. A Stat. Mech. Its Appl. 171, 26 (1991).</li>
</ol>
</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r067a00e66dac-2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[2]</td><td><em>(<a class="fn-backref" href="#id19">1</a>, <a class="fn-backref" href="#id24">2</a>)</em> <ol class="last upperalpha simple" start="3">
<li><ol class="first upperalpha" start="23">
<li><ol class="first upperalpha" start="10">
<li>Beenakker and P. Mazur, Phys. A Stat. Mech. Its Appl. 126, 349 (1984).</li>
</ol>
</li>
</ol>
</li>
</ol>
</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r067a00e66dac-3" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id25">[3]</a></td><td><ol class="first last upperalpha simple" start="3">
<li><ol class="first upperalpha" start="23">
<li><ol class="first upperalpha" start="10">
<li>Beenakker and P. Mazur, Phys. A Stat. Mech. Its Appl. 120, 388 (1983).</li>
</ol>
</li>
</ol>
</li>
</ol>
</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jscatter.structurefactor.latticeStructureFactor">
<code class="descclassname">jscatter.structurefactor.</code><code class="descname">latticeStructureFactor</code><span class="sig-paren">(</span><em>q</em>, <em>lattice=None</em>, <em>domainsize=1000</em>, <em>asym=0</em>, <em>lg=1</em>, <em>rmsd=0.02</em>, <em>beta=None</em>, <em>hklmax=7</em>, <em>c=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/structurefactor.html#latticeStructureFactor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.latticeStructureFactor" title="Permalink to this definition">¶</a></dt>
<dd><p>Radial structure factor S(q) of a crystal lattice with particle asymmetry, DebyeWaller factor, diffusive scattering and domain size.</p>
<p>The peak shape is a Voigt function.
To get the full scattering the formfactor needs to be included (See Notes and Examples).
1-3 dimensional lattice structures with basis containing multiple atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>q</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Wavevector in inverse units of lattice constant, units 1/A or 1/nm</p>
</dd>
<dt><strong>domainsize</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Domainsize of the crystal, units as lattice constant of lattice.
According to Debye-Scherrer equation <span class="math">fwhm=2\pi/domainsize</span> the peak width is determined <a class="reference internal" href="#r0319d63fa12e-2" id="id26">[2]</a>.</p>
</dd>
<dt><strong>lattice</strong> <span class="classifier-delimiter">:</span> <span class="classifier">lattice object</span></dt>
<dd><p class="first last">The crystal structure as defined in a lattice object. The size of the lattice is ignored.
One of rhombicLattice, bravaisLattice, scLattice, bccLattice, fccLattice, diamondLattice, hexLattice, hcpLattice.
See respective definitions.</p>
</dd>
<dt><strong>lg</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, default = 1</span></dt>
<dd><dl class="first last docutils">
<dt>Lorenzian/gaussian fraction describes the contributions of gaussian and lorenzian shape in peak shape.</dt>
<dd><ul class="first last simple">
<li>lorenzian/gaussian &gt;&gt; 1  lorenzian,</li>
<li>lorenzian/gaussian ~  1  central part gaussian, outside lorenzian wings</li>
<li>lorenzian/gaussian &lt;&lt; 1. gaussian</li>
</ul>
</dd>
</dl>
</dd>
<dt><strong>asym</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, default=0</span></dt>
<dd><p class="first last">Asymmetry factor in sigmoidal as <span class="math">2*fwhm/(1+np.exp(asym*(x-center)))</span>
For a=0 the Voigt is symmetric with fwhm. See formel.voigt .</p>
</dd>
<dt><strong>rmsd</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, default=0.02</span></dt>
<dd><p class="first last">Root mean square displacement <span class="math">&lt;u^2&gt;^{0.5}</span> determining the Debye Waller factor.
Units as a.</p>
</dd>
<dt><strong>beta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, None, dataArray</span></dt>
<dd><dl class="first last docutils">
<dt>Asymmetry factor of the formfactor or reduction due to polydispersity.</dt>
<dd><ul class="first last simple">
<li>None beta=1, No beta assumed (spherical symmetric formfactor, no polydispersity)</li>
<li>dataArray explicitly given as dataArray with beta in .Y column.
Missing values are interpolated.</li>
<li>An approximation for polydisperse beta can be found in <a class="reference internal" href="#r0319d63fa12e-1" id="id27">[1]</a> equ.17.
This can be realized by  beta=js.dA(np.vstack(q,np.exp(-(q*sr*R)**2)))
with sr as relative standard deviation of gaussian distribution of the size R.</li>
<li>See .formfactor for different formfactors which explicit calculation of beta.</li>
</ul>
</dd>
</dl>
</dd>
<dt><strong>hklmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Maximum order of the Bragg peaks to include.</p>
</dd>
<dt><strong>c</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, default=1</span></dt>
<dd><p class="first last">Porod constant. See 3.8 in <a class="reference internal" href="#r0319d63fa12e-1" id="id28">[1]</a>.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>dataArray with columns [q,Sq,DW,beta,Z0q]</strong></dt>
<dd><blockquote class="first">
<div><ul class="simple">
<li>q wavevector</li>
<li>Sq = S(q) = 1+beta(q)*(Z0(q)-1)*DW(q) structure factor</li>
<li>DW(q)   Debye-Waller factor with (1-DW)=diffusive scattering.</li>
<li>beta(q)   asymmetry factor of the formfactor.</li>
<li>Z0q       lattice factor Z0(q)</li>
</ul>
</div></blockquote>
<dl class="last docutils">
<dt>Attributes</dt>
<dd><ul class="first last simple">
<li>.q_hkl    peak positions</li>
<li>.fhkl     symmetry factor</li>
<li>.mhkl     multiplicity</li>
</ul>
</dd>
</dl>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<ul>
<li><p class="first">The scattering intensity of a crystal domain is</p>
<div class="math">
<p><span class="math">I(q)={\Delta\rho}^2 n P(q) S(q)</span></p>
</div><dl class="docutils">
<dt>with</dt>
<dd><ul class="first last simple">
<li><span class="math">\Delta\rho</span> scattering length difference between matrix and particles</li>
<li><span class="math">n</span> number density (of elementary cells)</li>
<li><span class="math">P(q)</span> form factor</li>
<li><span class="math">S(q)</span> structure factor <span class="math">S(q)</span></li>
</ul>
</dd>
</dl>
<p>For inhomogenious particles we can incorporate <span class="math">\Delta\rho(r)</span> in the formfactor <span class="math">P(q)</span>
if this includes the integrated scattering length differences.</p>
</li>
<li><p class="first">The structure factor is <a class="reference internal" href="#r0319d63fa12e-1" id="id29">[1]</a> :</p>
<div class="math">
<p><span class="math">S(q)=1+ \beta(q)(Z_0(q)-1)*DW(Q)</span></p>
</div><dl class="docutils">
<dt>with</dt>
<dd><ul class="first last simple">
<li><span class="math">\beta(q)=&lt;F(q)&gt;^2/&lt;F(q)^2&gt;</span> as asymmetry factor <a class="reference internal" href="#r0319d63fa12e-3" id="id30">[3]</a> dependent on the
scattering amplitude <span class="math">F(q)</span> and particle polydiispersity</li>
<li><span class="math">DW(q)</span> Debye Waller factor</li>
</ul>
</dd>
</dl>
</li>
<li><p class="first">The  lattice factor is <a class="reference internal" href="#r0319d63fa12e-1" id="id31">[1]</a> :</p>
<div class="math">
<p><span class="math">Z_0(q) = \frac{(2\pi)^{d-1}c}{nv_dq^{d-1}} \sum\limits_{hkl}m_{hkl}f_{hkl}^2L_{hkl}(q)</span></p>
</div><dl class="docutils">
<dt>with</dt>
<dd><ul class="first last simple">
<li><span class="math">n</span>           number of particles per unit cell</li>
<li><span class="math">f_{hkl}</span>     unit cell structure factor that takes into account symmetry-related extinction rules</li>
<li><span class="math">v_d</span>         volume of the d-dimensional unit cell</li>
<li><span class="math">hkl</span>         reflections</li>
<li><span class="math">m_{hkl}</span>     peak multiplicity</li>
<li><span class="math">c</span>           Porod constant <span class="math">\simeq 1</span></li>
</ul>
</dd>
</dl>
</li>
<li><p class="first">We use a Voigt function for the peak shape <span class="math">L_{hkl}(q)</span> (see formel.voigt).</p>
</li>
<li><p class="first">DW is a Debye Waller like factor as <span class="math">DW(q)=e^{-q^2&lt;u^2&gt;}</span> leading to a reduction
of scattered intensity and diffusive scattering.
It has contributions from thermal lattice disorder ( DW factor with 1/3 factor in 3D),
surface roughness and size polydispersity.</p>
</li>
<li><dl class="first docutils">
<dt>For the limitting behaviour q-&gt;0 see the discussion in <a class="reference internal" href="#r0319d63fa12e-1" id="id32">[1]</a> in 3.9. :</dt>
<dd><p class="first last">“… The zero-order peak is not explicitely considered because of the q^(1-dim) singularity and
because its intensity depends also on the scattering length difference between the lattice inside and outside……
Due to the singularity and since structural features on length scales d &gt; a,
such as packing defects, grain boundaries or fluctuations decaying on larger length scales
are only indirectly considered via the domain size D, eq 30 is not expected to give good agreement with
experimentally determined scattering curves in the range of scattering vectors q &lt; 2π/a.
However, for q &gt; 2π/a, this approach describes remarkably well experimentally measured
high-resolution scattering curves….”</p>
</dd>
</dl>
<p>A good description of the real scattering for low Q is shown in
example <a class="reference internal" href="examples.html#a-nano-cube-build-of-different-lattices"><span class="std std-ref">A nano cube build of different lattices</span></a>.</p>
</li>
</ul>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r0319d63fa12e-1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td><em>(<a class="fn-backref" href="#id27">1</a>, <a class="fn-backref" href="#id28">2</a>, <a class="fn-backref" href="#id29">3</a>, <a class="fn-backref" href="#id31">4</a>, <a class="fn-backref" href="#id32">5</a>, <a class="fn-backref" href="#id33">6</a>)</em> Scattering curves of ordered mesoscopic materials.
Förster, S. et al. J. Phys. Chem. B 109, 1347–1360 (2005).</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r0319d63fa12e-2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[2]</td><td><em>(<a class="fn-backref" href="#id26">1</a>, <a class="fn-backref" href="#id34">2</a>)</em> Patterson, A.
The Scherrer Formula for X-Ray Particle Size Determination
Phys. Rev. 56 (10): 978–982 (1939)
doi:10.1103/PhysRev.56.978.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r0319d63fa12e-3" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[3]</td><td><em>(<a class="fn-backref" href="#id30">1</a>, <a class="fn-backref" href="#id35">2</a>)</em> <ol class="last upperalpha simple" start="13">
<li>Kotlarchyk and S.-H. Chen, J. Chem. Phys. 79, 2461 (1983).1</li>
</ol>
</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jscatter</span> <span class="k">as</span> <span class="nn">js</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mf">0.001</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">800</span><span class="n">j</span><span class="p">]</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">50.</span>
<span class="n">R</span><span class="o">=</span><span class="mi">15</span>
<span class="n">sr</span><span class="o">=</span><span class="mf">0.1</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">js</span><span class="o">.</span><span class="n">grace</span><span class="p">()</span>
<span class="n">beta</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">dA</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">q</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">q</span><span class="o">*</span><span class="n">sr</span><span class="o">*</span><span class="n">R</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)]))</span>
<span class="n">p</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;structure factor for hexagonal 2D lattice&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">subtitle</span><span class="p">(</span><span class="s1">&#39;with diffusive scattering and asymmetry factor beta&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">rmsd</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span> <span class="mf">30.</span><span class="p">],</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">grid</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">sf</span><span class="o">.</span><span class="n">hexLattice</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
    <span class="nb">hex</span> <span class="o">=</span> <span class="n">js</span><span class="o">.</span><span class="n">sf</span><span class="o">.</span><span class="n">latticeStructureFactor</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">rmsd</span><span class="o">=</span><span class="n">rmsd</span><span class="p">,</span> <span class="n">domainsize</span><span class="o">=</span><span class="mf">500.</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span><span class="n">lattice</span><span class="o">=</span><span class="n">grid</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">hex</span><span class="p">,</span> <span class="n">li</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="n">sy</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">le</span><span class="o">=</span><span class="s1">&#39;rmsd=$rmsd&#39;</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">hex</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="nb">hex</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="n">li</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="n">sy</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">hex</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="nb">hex</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">li</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="n">sy</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">le</span><span class="o">=</span><span class="s1">&#39;beta&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;broken lines \nshow diffusive scattering&#39;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">yaxis</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;S(q)&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">xaxis</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;q / nm&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">jscatter</span> <span class="k">as</span> <span class="nn">js</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">q</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">js</span><span class="o">.</span><span class="n">loglist</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">200</span><span class="p">),</span><span class="mi">3</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mi">800</span><span class="n">j</span><span class="p">]</span>
<span class="n">unitcelllength</span><span class="o">=</span><span class="mf">1.5</span>
<span class="n">N</span><span class="o">=</span><span class="mi">2</span>
<span class="n">R</span><span class="o">=</span><span class="mf">0.5</span>
<span class="n">sr</span><span class="o">=</span><span class="mf">0.1</span>
<span class="n">beta</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">dA</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">q</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">q</span><span class="o">*</span><span class="n">sr</span><span class="o">*</span><span class="n">R</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)]))</span>
<span class="n">rmsd</span><span class="o">=</span><span class="mf">0.02</span>
<span class="c1">#</span>
<span class="n">scgrid</span><span class="o">=</span> <span class="n">js</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">scLattice</span><span class="p">(</span><span class="n">unitcelllength</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">sc</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">sf</span><span class="o">.</span><span class="n">latticeStructureFactor</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">rmsd</span><span class="o">=</span><span class="n">rmsd</span><span class="p">,</span> <span class="n">domainsize</span><span class="o">=</span><span class="mf">50.</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span><span class="n">lattice</span><span class="o">=</span><span class="n">scgrid</span><span class="p">)</span>
<span class="n">bccgrid</span><span class="o">=</span> <span class="n">js</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">bccLattice</span><span class="p">(</span><span class="n">unitcelllength</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">bcc</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">sf</span><span class="o">.</span><span class="n">latticeStructureFactor</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">rmsd</span><span class="o">=</span><span class="n">rmsd</span><span class="p">,</span> <span class="n">domainsize</span><span class="o">=</span><span class="mf">50.</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span><span class="n">lattice</span><span class="o">=</span><span class="n">bccgrid</span><span class="p">)</span>
<span class="n">fccgrid</span><span class="o">=</span> <span class="n">js</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">fccLattice</span><span class="p">(</span><span class="n">unitcelllength</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">fcc</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">sf</span><span class="o">.</span><span class="n">latticeStructureFactor</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">rmsd</span><span class="o">=</span><span class="n">rmsd</span><span class="p">,</span> <span class="n">domainsize</span><span class="o">=</span><span class="mf">50.</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span><span class="n">lattice</span><span class="o">=</span><span class="n">fccgrid</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">p</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">grace</span><span class="p">()</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sc</span><span class="p">,</span><span class="n">legend</span><span class="o">=</span><span class="s1">&#39;sc&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bcc</span><span class="p">,</span><span class="n">legend</span><span class="o">=</span><span class="s1">&#39;bcc&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fcc</span><span class="p">,</span><span class="n">legend</span><span class="o">=</span><span class="s1">&#39;fcc&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;broken lines \nshow diffusive scattering&#39;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">yaxis</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;S(q)&#39;</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">,</span><span class="nb">max</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="nb">min</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">xaxis</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;q / nm&#39;</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">,</span><span class="nb">max</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="nb">min</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span><span class="n">charsize</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="jscatter.structurefactor.latticeStructureFactor2D">
<code class="descclassname">jscatter.structurefactor.</code><code class="descname">latticeStructureFactor2D</code><span class="sig-paren">(</span><em>qxyz</em>, <em>lattice</em>, <em>orientation=None</em>, <em>rotation=None</em>, <em>domainsize=1000</em>, <em>rmsd=0.02</em>, <em>beta=None</em>, <em>hklmax=3</em>, <em>nGauss=13</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/structurefactor.html#latticeStructureFactor2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.latticeStructureFactor2D" title="Permalink to this definition">¶</a></dt>
<dd><p>2D structure factor S(q) of a crystal lattice including particle asymmetry, DebyeWaller factor,
diffusive scattering, rotation and domain size.</p>
<p>To get the full scattering the formfactor needs to be included (See Notes and Examples).
1-3 dimensional lattice structures with basis containing multiple atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>qxyz</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array 3xN</span></dt>
<dd><p class="first last">Wavevector array representing a surface in q space (3D), units 1/A or 1/nm.
This can describe a detector plane, section of the Ewald sphere or a line in reciprocal space.</p>
</dd>
<dt><strong>lattice</strong> <span class="classifier-delimiter">:</span> <span class="classifier">lattice object</span></dt>
<dd><p class="first last">Lattice object with arbitrary atoms particles in unit cell,
or predefined lattice from rhombicLattice, bravaisLattice, scLattice,bccLattice,
fccLattice, diamondLattice, hexLattice, hcpLattice with scattering length of unit cell atoms.
See lattices for examples.</p>
</dd>
<dt><strong>orientation</strong> <span class="classifier-delimiter">:</span> <span class="classifier">3 float as [h,k,l], None</span></dt>
<dd><dl class="first last docutils">
<dt>Orientation of the crystal relative to  qxyz surface.</dt>
<dd><ul class="first last simple">
<li>[h,k,l] rotates the crystal that the lattice hkl direction points to the center of qxyz (mean position).
e.g. points to plane center.</li>
<li>If None the orientation is not changed.</li>
</ul>
</dd>
</dl>
</dd>
<dt><strong>rotation</strong> <span class="classifier-delimiter">:</span> <span class="classifier">5 float as [mean,sigma,h,k,l], None</span></dt>
<dd><p class="first last">Rotation of the crystal around axis hkl with Gaussian distribution around mean and width sigma (units rad).</p>
</dd>
<dt><strong>domainsize</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float,list, list of directions</span></dt>
<dd><p class="first">Domainsize of the crystal, units as lattice constant of lattice.
According to Debye-Scherrer equation <span class="math">fwhm=2\pi/domainsize</span> the peak width is determined <a class="reference internal" href="#ra48da02f4e86-2" id="id36">[2]</a>.</p>
<blockquote class="last">
<div><ul class="simple">
<li>float        : assume same domainsize in all directions.</li>
<li>list 3 float : domainsize in directions of latticeVectors.</li>
<li><dl class="first docutils">
<dt>list 4 x 3 <span class="classifier-delimiter">:</span> <span class="classifier">3 times domainsize in hkl direction as [[size,h,k,l] ,[..],[..] ]</span></dt>
<dd>[[3,1,1,1],[100,1,-1,0],[100,1,1,-2]]  is thin in 111 direction and others are thick
The user should take care that the directions are nearly orthogonal.</dd>
</dl>
</li>
</ul>
</div></blockquote>
</dd>
<dt><strong>rmsd</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, default=0.02</span></dt>
<dd><p class="first last">Root mean square displacement <span class="math">&lt;u^2&gt;^{0.5}</span> determining the Debye Waller factor.
Units as lattice constant.</p>
</dd>
<dt><strong>beta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, None, dataArray</span></dt>
<dd><dl class="first last docutils">
<dt>Asymmetry factor of the formfactor or reduction due to polydispersity.</dt>
<dd><ul class="first last simple">
<li>None beta=1, No beta assumed (spherical symmetric formfactor, no polydispersity)</li>
<li>dataArray beta explicitly given as dataArray with beta in .Y column.
Missing values are interpolated.</li>
<li>An approximation for polydisperse beta can be found in <a class="reference internal" href="#ra48da02f4e86-1" id="id37">[1]</a> equ.17.
This can be realized by  beta=js.dA(np.vstack(q,np.exp(-(q*sr*R)**2)))
with sr as relative standard deviation of gaussian distribution of the size R.</li>
<li>See .formfactor for different formfactors which explicit calculation of beta.</li>
</ul>
</dd>
</dl>
</dd>
<dt><strong>hklmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Maximum order of the Bragg peaks.</p>
</dd>
<dt><strong>nGauss</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, default 13</span></dt>
<dd><p class="first last">Number of points in integration over Gaussian for rotation width sigma.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>dataArray with columns [qx,qy,qz,Sq,DW,beta,Z0q]</strong></dt>
<dd><blockquote class="first">
<div><ul class="simple">
<li>q wavevector</li>
<li>Sq = S(q) = 1+beta(q)*(Z0(q)-1)*DW(q) structure factor</li>
<li>DW(q)     Debye-Waller factor with (1-DW)=diffusive scattering.</li>
<li>beta(q)   asymmetry factor of the formfactor.</li>
<li>Z0q       lattice factor Z0(q)</li>
</ul>
</div></blockquote>
<dl class="last docutils">
<dt>Attributes (+ input parameters)</dt>
<dd><ul class="first last simple">
<li>.q_hkl    peak positions</li>
<li>.hkl      Miller indices</li>
<li>.peakFWHM full width half maximum</li>
</ul>
</dd>
</dl>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<ul>
<li><p class="first">The scattering intensity of a crystal domain is</p>
<div class="math">
<p><span class="math">I(q)={\Delta\rho}^2 n P(q) S(q)</span></p>
</div><dl class="docutils">
<dt>with</dt>
<dd><ul class="first last simple">
<li><span class="math">\Delta\rho</span> scattering length difference between matrix and particles</li>
<li><span class="math">n</span> number density (of elementary cells)</li>
<li><span class="math">P(q)</span> form factor</li>
<li><span class="math">S(q)</span> structure factor <span class="math">S(q)</span></li>
</ul>
</dd>
</dl>
<p>For inhomogenious particles we can incorporate <span class="math">\Delta\rho(r)</span> in the formfactor <span class="math">P(q)</span>
if this includes the integrated scattering length differences.</p>
</li>
<li><p class="first">The structure factor is <a class="reference internal" href="#ra48da02f4e86-1" id="id38">[1]</a> :</p>
<div class="math">
<p><span class="math">S(q)=1+ \beta(q)(Z_0(q)-1)*DW(Q)</span></p>
</div><dl class="docutils">
<dt>with</dt>
<dd><ul class="first last simple">
<li><span class="math">\beta(q)=&lt;F(q)&gt;^2/&lt;F(q)^2&gt;</span> as asymmetry factor <a class="reference internal" href="#ra48da02f4e86-3" id="id39">[3]</a> dependent on the
scattering amplitude <span class="math">F(q)</span> and particle polydispersity</li>
<li><span class="math">DW(q)</span> Debye Waller factor</li>
</ul>
</dd>
</dl>
</li>
<li><p class="first">The  lattice factor is <a class="reference internal" href="#ra48da02f4e86-1" id="id40">[1]</a> :</p>
<div class="math">
<p><span class="math">Z_0(q) = \frac{(2\pi)^3}{mv} \sum\limits_{hkl}f_{hkl}^2L_{hkl}(q,g_{hkl})</span></p>
</div><dl class="docutils">
<dt>with</dt>
<dd><ul class="first last simple">
<li><span class="math">g_{hkl}</span>     peak positions</li>
<li><span class="math">m</span>           number of particles per unit cell</li>
<li><span class="math">f_{hkl}</span>     unit cell structure factor that takes into account symmetry-related extinction rules</li>
<li><span class="math">v</span>         volume of the unit cell</li>
<li><span class="math">hkl</span>         reflections</li>
</ul>
</dd>
</dl>
</li>
<li><p class="first">The peak shape function is</p>
<div class="math">
<p><span class="math">L_{hkl}(q,g_{hkl}) = \frac{1}{ \sqrt{2\pi} \sigma} e^{-\frac{(q-g_{hkl})^2}{2\sigma^2}}</span></p>
</div><p>with <span class="math">\sigma=fwhm/2\sqrt{2log(2)}</span> related to the domainsize.</p>
<p>Correspondingly <span class="math">\sigma</span> is a vector describing the peak shapes in all directions.</p>
</li>
<li><p class="first">Distributions of domain orientation are included by the parameter rotation that describes
gaussian distributions with mean and sigma around an axis defined by the corresponding hkl indices.</p>
</li>
<li><p class="first">DW is a Debye Waller like factor as <span class="math">DW(q)=e^{-q^2&lt;u^2&gt;}</span> leading to a reduction
of scattered intensity and diffusive scattering.
It has contributions from thermal lattice disorder
( DW factor with 1/3 factor in 3D).</p>
</li>
</ul>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="ra48da02f4e86-1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td><em>(<a class="fn-backref" href="#id37">1</a>, <a class="fn-backref" href="#id38">2</a>, <a class="fn-backref" href="#id40">3</a>, <a class="fn-backref" href="#id41">4</a>)</em> Order  causes  secondary  Bragg  peaks  in soft  materials
Förster et al Nature Materials doi: 10.1038/nmat1995</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="ra48da02f4e86-2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[2]</td><td><em>(<a class="fn-backref" href="#id36">1</a>, <a class="fn-backref" href="#id42">2</a>)</em> Patterson, A.
The Scherrer Formula for X-Ray Particle Size Determination
Phys. Rev. 56 (10): 978–982 (1939)
doi:10.1103/PhysRev.56.978.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="ra48da02f4e86-3" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[3]</td><td><em>(<a class="fn-backref" href="#id39">1</a>, <a class="fn-backref" href="#id43">2</a>)</em> <ol class="last upperalpha simple" start="13">
<li>Kotlarchyk and S.-H. Chen, J. Chem. Phys. 79, 2461 (1983).1</li>
</ol>
</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>Comparison fcc and sc to demonstrate selection rules</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jscatter</span> <span class="k">as</span> <span class="nn">js</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">R</span><span class="o">=</span><span class="mi">8</span>
<span class="n">N</span><span class="o">=</span><span class="mi">50</span>
<span class="n">ds</span><span class="o">=</span><span class="mi">10</span>
<span class="n">fcclattice</span><span class="o">=</span> <span class="n">js</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">fccLattice</span><span class="p">(</span><span class="mf">3.1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">qxy</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="o">-</span><span class="n">R</span><span class="p">:</span><span class="n">R</span><span class="p">:</span><span class="n">N</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="n">R</span><span class="p">:</span><span class="n">R</span><span class="p">:</span><span class="n">N</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">qxyz</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">qxy</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span><span class="p">)]</span>
<span class="n">ffe</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">sf</span><span class="o">.</span><span class="n">latticeStructureFactor2D</span><span class="p">(</span><span class="n">qxyz</span><span class="p">,</span><span class="n">fcclattice</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">domainsize</span><span class="o">=</span><span class="n">ds</span><span class="p">,</span><span class="n">rmsd</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">hklmax</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">fig</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">mpl</span><span class="o">.</span><span class="n">surface</span><span class="p">(</span><span class="n">qxyz</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">qxyz</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">ffe</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="n">sclattice</span><span class="o">=</span> <span class="n">js</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">scLattice</span><span class="p">(</span><span class="mf">3.1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">ffs</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">sf</span><span class="o">.</span><span class="n">latticeStructureFactor2D</span><span class="p">(</span><span class="n">qxyz</span><span class="p">,</span><span class="n">sclattice</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">domainsize</span><span class="o">=</span><span class="n">ds</span><span class="p">,</span><span class="n">rmsd</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">hklmax</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">fig</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">mpl</span><span class="o">.</span><span class="n">surface</span><span class="p">(</span><span class="n">qxyz</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">qxyz</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">ffs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
</pre></div>
</div>
<p>Comparison of different domainsizes dependent on direction of scattering</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jscatter</span> <span class="k">as</span> <span class="nn">js</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">R</span><span class="o">=</span><span class="mi">8</span>
<span class="n">N</span><span class="o">=</span><span class="mi">50</span>
<span class="n">qxy</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="o">-</span><span class="n">R</span><span class="p">:</span><span class="n">R</span><span class="p">:</span><span class="n">N</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="n">R</span><span class="p">:</span><span class="n">R</span><span class="p">:</span><span class="n">N</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">qxyz</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">qxy</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span><span class="p">)]</span>
<span class="n">sclattice</span><span class="o">=</span> <span class="n">js</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">scLattice</span><span class="p">(</span><span class="mf">2.1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">ds</span><span class="o">=</span><span class="p">[[</span><span class="mi">20</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">ffs</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">sf</span><span class="o">.</span><span class="n">latticeStructureFactor2D</span><span class="p">(</span><span class="n">qxyz</span><span class="p">,</span><span class="n">sclattice</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">domainsize</span><span class="o">=</span><span class="n">ds</span><span class="p">,</span><span class="n">rmsd</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">hklmax</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">fig</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">mpl</span><span class="o">.</span><span class="n">surface</span><span class="p">(</span><span class="n">qxyz</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">qxyz</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">ffs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;symmetric peaks: thiner direction perpendicular to scattering plane&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">ffs</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">sf</span><span class="o">.</span><span class="n">latticeStructureFactor2D</span><span class="p">(</span><span class="n">qxyz</span><span class="p">,</span><span class="n">sclattice</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">domainsize</span><span class="o">=</span><span class="n">ds</span><span class="p">,</span><span class="n">rmsd</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">hklmax</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">fig2</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">mpl</span><span class="o">.</span><span class="n">surface</span><span class="p">(</span><span class="n">qxyz</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">qxyz</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">ffs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="n">fig2</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;asymmetric peaks: thin direction is parallel to scattering plane&#39;</span><span class="p">)</span>
<span class="n">fig2</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Rotation along [1,1,1] axis. It looks spiky because of low number of points in xy plane</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jscatter</span> <span class="k">as</span> <span class="nn">js</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="c1"># make xy grid in q space</span>
<span class="n">R</span><span class="o">=</span><span class="mi">8</span>    <span class="c1"># maximum</span>
<span class="n">N</span><span class="o">=</span><span class="mi">800</span>  <span class="c1"># number of points</span>
<span class="n">qxy</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="o">-</span><span class="n">R</span><span class="p">:</span><span class="n">R</span><span class="p">:</span><span class="n">N</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="n">R</span><span class="p">:</span><span class="n">R</span><span class="p">:</span><span class="n">N</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="c1"># add z=0 component</span>
<span class="n">qxyz</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">qxy</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span><span class="p">)]</span> <span class="c1"># as position vectors</span>
<span class="c1"># create sc lattice which includes reciprocal lattice vectors and methods to get peak positions</span>
<span class="n">sclattice</span><span class="o">=</span> <span class="n">js</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">scLattice</span><span class="p">(</span><span class="mf">2.1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="c1"># We orient to 111 direction perpendicular to center of qxy plane</span>
<span class="c1"># this needs crystal rotation by 15 degrees to be alligned to xy plane after rotation to 111 direction</span>
<span class="c1"># The crystals rotates by 10 degrees around 111 to broaden peaks.</span>
<span class="n">ds</span><span class="o">=</span><span class="mi">15</span><span class="p">;</span> <span class="n">fpi</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span>
<span class="n">ffs</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">sf</span><span class="o">.</span><span class="n">latticeStructureFactor2D</span><span class="p">(</span><span class="n">qxyz</span><span class="p">,</span><span class="n">sclattice</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                                        <span class="n">rotation</span><span class="o">=</span><span class="p">[(</span><span class="mi">30</span><span class="o">+</span><span class="mi">15</span><span class="p">)</span><span class="o">*</span><span class="n">fpi</span><span class="p">,</span><span class="mi">10</span><span class="o">*</span><span class="n">fpi</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                                        <span class="n">domainsize</span><span class="o">=</span><span class="n">ds</span><span class="p">,</span><span class="n">rmsd</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">hklmax</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">nGauss</span><span class="o">=</span><span class="mi">23</span><span class="p">)</span>
<span class="n">fig</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">mpl</span><span class="o">.</span><span class="n">surface</span><span class="p">(</span><span class="n">qxyz</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">qxyz</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">ffs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;10 degree rotation around 111 direction&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="jscatter.structurefactor.sq2gr">
<code class="descclassname">jscatter.structurefactor.</code><code class="descname">sq2gr</code><span class="sig-paren">(</span><em>Sq</em>, <em>R</em>, <em>interpolatefactor=2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/structurefactor.html#sq2gr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.sq2gr" title="Permalink to this definition">¶</a></dt>
<dd><p>Radial distribution function g(r) from structure factor Sq.</p>
<p>The result strongly depends on quality of S(Q) (number of data points, Q range, smoothness).
Read <a class="reference internal" href="#r2fea80e76d2e-2" id="id44">[2]</a> for details of this inversion problem and why it may fail.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>Sq</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dataArray</span></dt>
<dd><dl class="first last docutils">
<dt>Structure factor e.g. in units as [Q]=1/nm</dt>
<dd><ul class="first last simple">
<li>.X wavevector</li>
<li>.Y structure factor</li>
</ul>
</dd>
</dl>
</dd>
<dt><strong>R</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Estimate for the radius of the particles.</p>
</dd>
<dt><strong>interpolatefactor</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Number of points between points in interpolation for rfft.
2 doubles the points</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>dataArray</strong></dt>
<dd><p class="first last">.n0  approximated from <span class="math">2\pi^2 n_0=\int_0^{Q_{max}}  [S(Q) -1]Q^2 dQ</span></p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>One finds that</p>
<div class="math">
<p><span class="math">g(r)-1=(2\pi^2 n_0 r)^{-1} \int_0^\infty  [S(Q) -1]Qsin(qr)dQ</span></p>
</div><p>with <span class="math">2\pi^2 n_0=\int_0^\infty  [S(Q) -1]Q^2 dQ</span> defining <span class="math">n_0</span>.</p>
<p>As we have only a limited Q range (<span class="math">0 &lt; Q &lt; \infty</span> ), limited accuracy and number of Q values
we require that <span class="math">mean(g(R/2&lt;r&lt;R3/4))=0</span>.</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r2fea80e76d2e-1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id45">[1]</a></td><td>Yarnell, J. L., Katz, M. J., Wenzel, R. G., &amp; Koenig, S. H. (1973).
Structure factor and radial distribution function for liquid argon at 85 K.
Physical Review A, 7(6), 2130.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r2fea80e76d2e-2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[2]</td><td><em>(<a class="fn-backref" href="#id44">1</a>, <a class="fn-backref" href="#id46">2</a>)</em> On the determination of the pair correlation function from liquid structure factor measurements
A.K. Soper Chemical Physics 107, 61-74, (1986)</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jscatter</span> <span class="k">as</span> <span class="nn">js</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">p</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">grace</span><span class="p">()</span>
<span class="n">p</span><span class="o">.</span><span class="n">multi</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">q</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">loglist</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="o">**</span><span class="mi">13</span><span class="p">)</span>
<span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">clear</span><span class="p">();</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="n">R</span><span class="o">=</span><span class="mf">2.5</span>
<span class="n">eta</span><span class="o">=</span><span class="mf">0.3</span><span class="p">;</span><span class="n">scl</span><span class="o">=</span><span class="mi">5</span>
<span class="n">n</span><span class="o">=</span><span class="n">eta</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">/</span><span class="mf">3.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">R</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>   <span class="c1"># unit 1/nm**3</span>
<span class="n">sf</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">sf</span><span class="o">.</span><span class="n">RMSA</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="n">R</span><span class="p">,</span><span class="n">scl</span><span class="o">=</span><span class="n">scl</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">eta</span><span class="o">=</span><span class="n">eta</span><span class="p">)</span>
<span class="n">gr</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">sf</span><span class="o">.</span><span class="n">sq2gr</span><span class="p">(</span><span class="n">sf</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">interpolatefactor</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sfcut</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">sf</span><span class="o">.</span><span class="n">RMSA</span><span class="p">(</span><span class="n">js</span><span class="o">.</span><span class="n">loglist</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="o">**</span><span class="mi">10</span><span class="p">),</span><span class="n">R</span><span class="o">=</span><span class="n">R</span><span class="p">,</span><span class="n">scl</span><span class="o">=</span><span class="n">scl</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">eta</span><span class="o">=</span><span class="n">eta</span><span class="p">)</span>
<span class="n">grcut</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">sf</span><span class="o">.</span><span class="n">sq2gr</span><span class="p">(</span><span class="n">sfcut</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">interpolatefactor</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sf</span><span class="o">.</span><span class="n">X</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">R</span><span class="p">,</span><span class="n">sf</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span><span class="n">le</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;\xG=50&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">gr</span><span class="o">.</span><span class="n">X</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">R</span><span class="p">,</span><span class="n">gr</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">le</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;\xG=50&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">grcut</span><span class="o">.</span><span class="n">X</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">R</span><span class="p">,</span><span class="n">grcut</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">le</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;\xG=50 \f</span><span class="si">{}</span><span class="s1">Q\smax\N=10&#39;</span><span class="p">)</span>
<span class="n">sfh</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">sf</span><span class="o">.</span><span class="n">RMSA</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="n">R</span><span class="p">,</span><span class="n">scl</span><span class="o">=</span><span class="n">scl</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">eta</span><span class="o">=</span><span class="n">eta</span><span class="p">)</span>
<span class="n">grh</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">sf</span><span class="o">.</span><span class="n">sq2gr</span><span class="p">(</span><span class="n">sfh</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">interpolatefactor</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sfh</span><span class="o">.</span><span class="n">X</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">R</span><span class="p">,</span><span class="n">sfh</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span><span class="n">le</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;\xG=0.01&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">grh</span><span class="o">.</span><span class="n">X</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">R</span><span class="p">,</span><span class="n">grh</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">le</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;\xG=0.01&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="p">(</span><span class="nb">max</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;2RQ&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="p">(</span><span class="nb">max</span><span class="o">=</span><span class="mi">4</span><span class="o">*</span><span class="n">R</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;r/(2R)&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="p">(</span><span class="nb">max</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;S(Q)&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="p">(</span><span class="nb">max</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span><span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;g(r)&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mf">1.8</span><span class="p">)</span>
<span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mf">1.8</span><span class="p">)</span>
<span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Comparison RMSA&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">subtitle</span><span class="p">(</span><span class="s1">&#39;R=</span><span class="si">%.2g</span><span class="s1">, eta=</span><span class="si">%.2g</span><span class="s1">, scl=</span><span class="si">%.2g</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">eta</span><span class="p">,</span><span class="n">scl</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="jscatter.structurefactor.stickyHardSphere">
<code class="descclassname">jscatter.structurefactor.</code><code class="descname">stickyHardSphere</code><span class="sig-paren">(</span><em>q</em>, <em>R</em>, <em>width</em>, <em>depth</em>, <em>molarity=None</em>, <em>phi=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/structurefactor.html#stickyHardSphere"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.stickyHardSphere" title="Permalink to this definition">¶</a></dt>
<dd><p>Structure factor of a square well potential with depth and width (sticky hard spheres).</p>
<p>Sticky hard sphere model is derived using a perturbative solution of the factorized
form of the Ornstein-Zernike equation and the Percus-Yevick closure relation.
The perturbation parameter is width/(width+2R)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>q</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array; N dim</span></dt>
<dd><p class="first last">Scattering vector; units 1/(R[unit])</p>
</dd>
<dt><strong>R</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Radius of the hard sphere</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Volume fraction of the hard core particles</p>
</dd>
<dt><strong>molarity</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Number density in mol/l and defines q and R units to 1/nm and nm to be correct
Preferred over phi if both given.</p>
</dd>
<dt><strong>depth</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Potential well depth in kT
depth &gt;0 (U&lt;0); positive potential allowed (repulsive) see <a class="reference internal" href="#r6aeabe6ed83d-1" id="id47">[1]</a>.</p>
</dd>
<dt><strong>width</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Width of the square well</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<div class="line-block">
<div class="line">The potential U(r) is defined as</div>
<div class="line">r&lt;2R             U(r)=infinity</div>
<div class="line">2R&lt;r&lt;2R+width    U(r)=-depth   in [kT]</div>
<div class="line">r &gt;2R+width      U(r)=0</div>
</div>
<p>eps=width/(2*R+width) 
stickyness=exp(-depth)/12./eps</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r6aeabe6ed83d-1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td><em>(<a class="fn-backref" href="#id47">1</a>, <a class="fn-backref" href="#id48">2</a>)</em> S.V. G. Menon, C. Manohar, and K. S. Rao, J. Chem. Phys. 95, 9186 (1991)</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r6aeabe6ed83d-2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id49">[2]</a></td><td><ol class="first last upperalpha simple" start="13">
<li>Sztucki, T. Narayanan, G. Belina, A. Moussaïd, F. Pignon, and H. Hoekstra, Phys. Rev. E 74, 051504 (2006)</li>
</ol>
</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r6aeabe6ed83d-3" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id50">[3]</a></td><td>W.-R. Chen, S.-H. Chen, and F. Mallamace, Phys. Rev. E 66, 021403 (2002)</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r6aeabe6ed83d-4" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id51">[4]</a></td><td><ol class="first last upperalpha simple" start="7">
<li>Foffi, E. Zaccarelli, F. Sciortino, P. Tartaglia, and K. A. Dawson, J. Stat. Phys. 100, 363 (2000)</li>
</ol>
</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="jscatter.structurefactor.lattice">
<em class="property">class </em><code class="descclassname">jscatter.structurefactor.</code><code class="descname">lattice</code><a class="reference internal" href="_modules/jscatter/lattice.html#lattice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.lattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an arbitrary lattice</p>
<dl class="attribute">
<dt id="jscatter.structurefactor.lattice.X">
<code class="descname">X</code><a class="headerlink" href="#jscatter.structurefactor.lattice.X" title="Permalink to this definition">¶</a></dt>
<dd><p>X coordinates</p>
</dd></dl>

<dl class="attribute">
<dt id="jscatter.structurefactor.lattice.Y">
<code class="descname">Y</code><a class="headerlink" href="#jscatter.structurefactor.lattice.Y" title="Permalink to this definition">¶</a></dt>
<dd><p>Y coordinates</p>
</dd></dl>

<dl class="attribute">
<dt id="jscatter.structurefactor.lattice.Z">
<code class="descname">Z</code><a class="headerlink" href="#jscatter.structurefactor.lattice.Z" title="Permalink to this definition">¶</a></dt>
<dd><p>Z coordinates</p>
</dd></dl>

<dl class="attribute">
<dt id="jscatter.structurefactor.lattice.array">
<code class="descname">array</code><a class="headerlink" href="#jscatter.structurefactor.lattice.array" title="Permalink to this definition">¶</a></dt>
<dd><p>Coordinates and scattering length as array</p>
</dd></dl>

<dl class="attribute">
<dt id="jscatter.structurefactor.lattice.b">
<code class="descname">b</code><a class="headerlink" href="#jscatter.structurefactor.lattice.b" title="Permalink to this definition">¶</a></dt>
<dd><p>Scattering length</p>
</dd></dl>

<dl class="method">
<dt id="jscatter.structurefactor.lattice.centerOfMass">
<code class="descname">centerOfMass</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/lattice.html#lattice.centerOfMass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.lattice.centerOfMass" title="Permalink to this definition">¶</a></dt>
<dd><p>CenterOf mass</p>
</dd></dl>

<dl class="method">
<dt id="jscatter.structurefactor.lattice.filter">
<code class="descname">filter</code><span class="sig-paren">(</span><em>funktion</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/lattice.html#lattice.filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.lattice.filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter lattice points according to a function.</p>
<p>The existing points in the lattice size are tested.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>funktion</strong> <span class="classifier-delimiter">:</span> <span class="classifier">function returning bool</span></dt>
<dd><p class="first last">Function to select lattice points.
The function is applied with the point coordinates (array) as input.
This corresponds to .points[:,:3]</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>array</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>To select points inside of a sphere with radius 50 around [0,0,0]:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">xyz</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">xyz</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">50</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="jscatter.structurefactor.lattice.inSphere">
<code class="descname">inSphere</code><span class="sig-paren">(</span><em>R</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/lattice.html#lattice.inSphere"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.lattice.inSphere" title="Permalink to this definition">¶</a></dt>
<dd><p>Choose lattice points in sphere</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>R: float</strong></dt>
<dd><p class="first last">Radius of sphere around origin.
If negative the points outside are choosen</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="jscatter.structurefactor.lattice.limit2Cube">
<code class="descname">limit2Cube</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>c</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/lattice.html#lattice.limit2Cube"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.lattice.limit2Cube" title="Permalink to this definition">¶</a></dt>
<dd><p>Cut at cube with edges at</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>a,b,c</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Cut at +-[a,0,0],+-[0,b,0],+-[0,0,c]</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="jscatter.structurefactor.lattice.move">
<code class="descname">move</code><span class="sig-paren">(</span><em>vector</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/lattice.html#lattice.move"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.lattice.move" title="Permalink to this definition">¶</a></dt>
<dd><p>Move all points by vector.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>vector</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of 3 float or array</span></dt>
<dd><p class="first last">Vector to shift the points.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="jscatter.structurefactor.lattice.numberOfAtoms">
<code class="descname">numberOfAtoms</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/lattice.html#lattice.numberOfAtoms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.lattice.numberOfAtoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of Atoms</p>
</dd></dl>

<dl class="method">
<dt id="jscatter.structurefactor.lattice.planeSide">
<code class="descname">planeSide</code><span class="sig-paren">(</span><em>vector</em>, <em>invert=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/lattice.html#lattice.planeSide"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.lattice.planeSide" title="Permalink to this definition">¶</a></dt>
<dd><p>Select points on one side of a plane.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>vector</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list 3x float</span></dt>
<dd><p class="first last">Vector from origin to plane, perpendicular to plane.</p>
</dd>
<dt><strong>invert</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd><p class="first last">False choose points at origin side. True other side.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="jscatter.structurefactor.lattice.show">
<code class="descname">show</code><span class="sig-paren">(</span><em>R=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/lattice.html#lattice.show"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.lattice.show" title="Permalink to this definition">¶</a></dt>
<dd><p>Show the lattice in matplotlib.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>R</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float,None</span></dt>
<dd><p class="first last">Radius around origin to show.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>fig handle</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="jscatter.structurefactor.rhombicLattice">
<em class="property">class </em><code class="descclassname">jscatter.structurefactor.</code><code class="descname">rhombicLattice</code><span class="sig-paren">(</span><em>latticeVectors</em>, <em>size</em>, <em>unitCellAtoms=None</em>, <em>b=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/lattice.html#rhombicLattice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.rhombicLattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a rhombic lattice with specified unit cell atoms.</p>
<p>Allows to create 1D, 2D or 3D latices by using 1, 2 or 3 latticeVectors.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>latticeVectors</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of array 3x1</span></dt>
<dd><p class="first last">Lattice vectors defining the translation of the unit cell along its principal axes.</p>
</dd>
<dt><strong>size :3x integer or integer</strong></dt>
<dd><p class="first last">A list of integers describing the size in direction of the respective latticeVectors.
Size is symmetric around zero in interval [-i,..,i] with length 2i+1.
If one integer is given it is used for all 3 dimensions.</p>
</dd>
<dt><strong>unitCellAtoms</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of 3x1 array, None=[0,0,0]</span></dt>
<dd><p class="first last">Position vectors of atoms in the unit cell in relative units of the lattice vectors [0&lt;x&lt;1].</p>
</dd>
<dt><strong>b</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of float</span></dt>
<dd><p class="first last">Corresponding scattering length of atoms in the unit cell.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>lattice object</strong></dt>
<dd><p class="first last">.array  grid points as numpy array
.unitCellVolume         V = a1*a2 x a3 with latticeVectors a1, a2, a3;  if existing.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jscatter</span> <span class="k">as</span> <span class="nn">js</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="k">import</span> <span class="n">Axes3D</span>
<span class="c1"># cubic lattice with diatomic base</span>
<span class="n">grid</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">sf</span><span class="o">.</span><span class="n">rhombicLattice</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">],[[</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="o">-</span><span class="mf">0.1</span><span class="p">],[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">]],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">grid</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mf">1.5</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="jscatter.structurefactor.rhombicLattice.getRadialReciprocalLattice">
<code class="descname">getRadialReciprocalLattice</code><span class="sig-paren">(</span><em>size</em>, <em>includeZero=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/lattice.html#rhombicLattice.getRadialReciprocalLattice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.rhombicLattice.getRadialReciprocalLattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Get radial distribution of Bragg peaks with structure factor and multiplicity.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>size</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Size of the lattice as maximum included Miller indices.</p>
</dd>
<dt><strong>includeZero</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd><p class="first last">Include q=0 peak</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>3x list of [unique q values, structure factor fhkl(q)**2, multiplicity mhkl(q)]</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="jscatter.structurefactor.rhombicLattice.getReciprocalLattice">
<code class="descname">getReciprocalLattice</code><span class="sig-paren">(</span><em>size=2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/lattice.html#rhombicLattice.getReciprocalLattice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.rhombicLattice.getReciprocalLattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Reciprocal lattice of given size with peak scattering intensity.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>size</strong> <span class="classifier-delimiter">:</span> <span class="classifier">3x int, default 3</span></dt>
<dd><p class="first last">Number of reciprocal lattice points in each direction (+- direction).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>Array [N x 4] with</strong></dt>
<dd><p class="first last">reciprocal lattice vectors                 [:,:3]
corresponding structure factor fhkl**2&gt;0   [:, 3]</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="jscatter.structurefactor.rhombicLattice.rotate2hkl">
<code class="descname">rotate2hkl</code><span class="sig-paren">(</span><em>grid</em>, <em>h</em>, <em>k</em>, <em>l</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/lattice.html#rhombicLattice.rotate2hkl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.rhombicLattice.rotate2hkl" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate a grid to a plane perpendicular to hkl direction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>grid</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array Nx3</span></dt>
<dd><p class="first last">Grid points</p>
</dd>
<dt><strong>h,k,l</strong> <span class="classifier-delimiter">:</span> <span class="classifier">integer, float</span></dt>
<dd><p class="first last">Miller indices indicating the direction where to rotate to.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>grid points array 4xN</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jscatter</span> <span class="k">as</span> <span class="nn">js</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">R</span><span class="o">=</span><span class="mi">8</span>
<span class="n">N</span><span class="o">=</span><span class="mi">10</span>
<span class="n">qxy</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="o">-</span><span class="n">R</span><span class="p">:</span><span class="n">R</span><span class="p">:</span><span class="n">N</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="n">R</span><span class="p">:</span><span class="n">R</span><span class="p">:</span><span class="n">N</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">qxyz</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">qxy</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span><span class="p">)]</span>
<span class="n">fccgrid</span> <span class="o">=</span> <span class="n">js</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">fccLattice</span><span class="p">(</span><span class="mf">2.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">xyz</span><span class="o">=</span><span class="n">fccgrid</span><span class="o">.</span><span class="n">rotate2hkl</span><span class="p">(</span><span class="n">qxyz</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">p</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">mpl</span><span class="o">.</span><span class="n">scatter3d</span><span class="p">(</span><span class="n">xyz</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">xyz</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">xyz</span><span class="p">[:,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">p</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">fccgrid</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="n">fccgrid</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span><span class="n">fccgrid</span><span class="o">.</span><span class="n">Z</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="jscatter.structurefactor.rhombicLattice.unitCellAtomPositions">
<code class="descname">unitCellAtomPositions</code><a class="headerlink" href="#jscatter.structurefactor.rhombicLattice.unitCellAtomPositions" title="Permalink to this definition">¶</a></dt>
<dd><p>Absolute positions of unit cell atoms.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="jscatter.structurefactor.bravaisLattice">
<em class="property">class </em><code class="descclassname">jscatter.structurefactor.</code><code class="descname">bravaisLattice</code><span class="sig-paren">(</span><em>latticeVectors</em>, <em>size</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/lattice.html#bravaisLattice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.bravaisLattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a bravais lattice. Lattice with one atom in the unit cell.</p>
<p>See rhombicLattice for methods and attributes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>latticeVectors</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of array 1x3</span></dt>
<dd><p class="first last">Lattice vectors defining the translation of the unit cell along its principal axes.</p>
</dd>
<dt><strong>size :3x integer, integer</strong></dt>
<dd><p class="first last">A list of integers describing the size in direction of the respective latticeVectors.
Size is symmetric around zero in interval [-i,..,i] with length 2i+1.
If one integer is given it is used for all 3 dimensions.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>lattice object</strong></dt>
<dd><p class="first last">.array  grid points asnumpy array</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="jscatter.structurefactor.scLattice">
<em class="property">class </em><code class="descclassname">jscatter.structurefactor.</code><code class="descname">scLattice</code><span class="sig-paren">(</span><em>abc</em>, <em>size</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/lattice.html#scLattice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.scLattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple Cubic lattice.</p>
<p>See rhombicLattice for methods.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>abc</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Point distance.</p>
</dd>
<dt><strong>size</strong> <span class="classifier-delimiter">:</span> <span class="classifier">3x integer, integer</span></dt>
<dd><p class="first last">A list of integers describing the size in direction of the respective latticeVectors.
Size is symmetric around zero in interval [-i,..,i] with length 2i+1.
If one integer is given it is used for all 3 dimensions.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>lattice object</strong></dt>
<dd><p class="first last">.array  grid points as numpy array</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jscatter</span> <span class="k">as</span> <span class="nn">js</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="k">import</span> <span class="n">Axes3D</span>
<span class="n">grid</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">sf</span><span class="o">.</span><span class="n">bccLattice</span><span class="p">(</span><span class="mf">1.2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="jscatter.structurefactor.bccLattice">
<em class="property">class </em><code class="descclassname">jscatter.structurefactor.</code><code class="descname">bccLattice</code><span class="sig-paren">(</span><em>abc</em>, <em>size</em>, <em>b=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/lattice.html#bccLattice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.bccLattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Body centered cubic lattice.</p>
<p>See rhombicLattice for methods.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>abc</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Point distance.</p>
</dd>
<dt><strong>size</strong> <span class="classifier-delimiter">:</span> <span class="classifier">3x integer, integer</span></dt>
<dd><p class="first last">A list of integers describing the size in direction of the respective latticeVectors.
Size is symmetric around zero in interval [-i,..,i] with length 2i+1.
If one integer is given it is used for all 3 dimensions.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>lattice object</strong></dt>
<dd><p class="first last">.array  grid points as numpy array</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jscatter</span> <span class="k">as</span> <span class="nn">js</span>
<span class="n">grid</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">sf</span><span class="o">.</span><span class="n">bccLattice</span><span class="p">(</span><span class="mf">1.2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="jscatter.structurefactor.fccLattice">
<em class="property">class </em><code class="descclassname">jscatter.structurefactor.</code><code class="descname">fccLattice</code><span class="sig-paren">(</span><em>abc</em>, <em>size</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/lattice.html#fccLattice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.fccLattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Face centered cubic lattice.</p>
<p>See rhombicLattice for methods.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>abc</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Point distance.</p>
</dd>
<dt><strong>size</strong> <span class="classifier-delimiter">:</span> <span class="classifier">3x integer, integer</span></dt>
<dd><p class="first last">A list of integers describing the size in direction of the respective latticeVectors.
Size is symmetric around zero in interval [-i,..,i] with length 2i+1.
If one integer is given it is used for all 3 dimensions.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>lattice object</strong></dt>
<dd><p class="first last">.array  grid points as numpy array</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jscatter</span> <span class="k">as</span> <span class="nn">js</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="k">import</span> <span class="n">Axes3D</span>
<span class="n">grid</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">sf</span><span class="o">.</span><span class="n">fccLattice</span><span class="p">(</span><span class="mf">1.2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="jscatter.structurefactor.hexLattice">
<em class="property">class </em><code class="descclassname">jscatter.structurefactor.</code><code class="descname">hexLattice</code><span class="sig-paren">(</span><em>ab</em>, <em>size</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/lattice.html#hexLattice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.hexLattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple 2D hexagonal lattice.</p>
<p>See rhombicLattice for methods.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>ab</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Point distance.</p>
</dd>
<dt><strong>size</strong> <span class="classifier-delimiter">:</span> <span class="classifier">2x integer, integer</span></dt>
<dd><p class="first last">A list of integers describing the size in direction of the respective latticeVectors.
Size is symmetric around zero in interval [-i,..,i] with length 2i+1.
If one integer is given it is used for all 3 dimensions.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>lattice object</strong></dt>
<dd><p class="first last">.array  grid points as numpy array</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jscatter</span> <span class="k">as</span> <span class="nn">js</span>
<span class="n">grid</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">sf</span><span class="o">.</span><span class="n">hexLattice</span><span class="p">(</span><span class="mf">1.2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="jscatter.structurefactor.hcpLattice">
<em class="property">class </em><code class="descclassname">jscatter.structurefactor.</code><code class="descname">hcpLattice</code><span class="sig-paren">(</span><em>ab</em>, <em>size</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/lattice.html#hcpLattice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.hcpLattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Hexagonal closed packed lattice.</p>
<p>See rhombicLattice for methods.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>ab</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Point distance.
ab is distance in hexagonal plane, c = ab* (8/3)**0.5</p>
</dd>
<dt><strong>size</strong> <span class="classifier-delimiter">:</span> <span class="classifier">3x integer, integer</span></dt>
<dd><p class="first last">A list of integers describing the size in direction of the respective latticeVectors.
Size is symmetric around zero in interval [-i,..,i] with length 2i+1.
If one integer is given it is used for all 3 dimensions.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>lattice object</strong></dt>
<dd><p class="first last">.array  grid points as numpy array</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jscatter</span> <span class="k">as</span> <span class="nn">js</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="k">import</span> <span class="n">Axes3D</span>
<span class="n">grid</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">sf</span><span class="o">.</span><span class="n">hcpLattice</span><span class="p">(</span><span class="mf">1.2</span><span class="p">,[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">grid</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="jscatter.structurefactor.diamondLattice">
<em class="property">class </em><code class="descclassname">jscatter.structurefactor.</code><code class="descname">diamondLattice</code><span class="sig-paren">(</span><em>abc</em>, <em>size</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/lattice.html#diamondLattice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.diamondLattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Diamond cubic lattice with 8 atoms in unit cell.</p>
<p>See rhombicLattice for methods.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>abc</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Point distance.</p>
</dd>
<dt><strong>size</strong> <span class="classifier-delimiter">:</span> <span class="classifier">3x integer, integer</span></dt>
<dd><p class="first last">A list of integers describing the size in direction of the respective latticeVectors.
Size is symmetric around zero in interval [-i,..,i] with length 2i+1.
If one integer is given it is used for all 3 dimensions.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>lattice object</strong></dt>
<dd><p class="first last">.array  grid points as numpy array</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jscatter</span> <span class="k">as</span> <span class="nn">js</span>
<span class="n">grid</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">sf</span><span class="o">.</span><span class="n">diamondLattice</span><span class="p">(</span><span class="mf">1.2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="jscatter.structurefactor.pseudoRandomLattice">
<em class="property">class </em><code class="descclassname">jscatter.structurefactor.</code><code class="descname">pseudoRandomLattice</code><span class="sig-paren">(</span><em>size</em>, <em>numberOfPoints</em>, <em>b=None</em>, <em>seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/lattice.html#pseudoRandomLattice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.pseudoRandomLattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a  lattice with a pseudo random distribution of points.</p>
<p>Allows to create 1D, 2D or 3D pseudo random latices.
The Halton sequence is used with skiping the first seed elements of the Halton sequence.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>size :3x float</strong></dt>
<dd><p class="first last">Size of the lattice for each dimension relative to origin.</p>
</dd>
<dt><strong>numberOfPoints</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Number of points.</p>
</dd>
<dt><strong>b</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float,array</span></dt>
<dd><p class="first last">Scattering length of atoms. If arary the sequence is repeated to fill N atoms.</p>
</dd>
<dt><strong>seed</strong> <span class="classifier-delimiter">:</span> <span class="classifier">None, int</span></dt>
<dd><p class="first last">Seed for the Halton sequence by skiping the first seed elements of the sequence.
If None an random integer between 10 and 1e6 is choosen.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>lattice object</strong></dt>
<dd><p class="first last">.array  grid points as numpy array</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jscatter</span> <span class="k">as</span> <span class="nn">js</span>
<span class="n">grid</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">sf</span><span class="o">.</span><span class="n">pseudoRandomLattice</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span><span class="mi">3000</span><span class="p">)</span>
<span class="n">fig</span><span class="o">=</span><span class="n">grid</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/Jscatter1.gif" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="help.html">1. Beginners Guide / Help</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataArray.html">2. dataArray</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataList.html">3. dataList</a></li>
<li class="toctree-l1"><a class="reference internal" href="formel.html">4. formel</a></li>
<li class="toctree-l1"><a class="reference internal" href="sas.html">5. smallanglescattering (sas)</a></li>
<li class="toctree-l1"><a class="reference internal" href="formfactor.html">6. formfactor (ff)</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">7. structurefactor (sf)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#structure-factors">7.1. Structure Factors</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hydrodynamics">7.2. Hydrodynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pair-correlation">7.3. Pair Correlation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#lattice">7.4. Lattice</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dynamic.html">8. dynamic</a></li>
<li class="toctree-l1"><a class="reference internal" href="dls.html">9. dls</a></li>
<li class="toctree-l1"><a class="reference internal" href="parallel.html">10. parallel</a></li>
<li class="toctree-l1"><a class="reference internal" href="GracePlot.html">11. Plotting in XmGrace</a></li>
<li class="toctree-l1"><a class="reference internal" href="mpl.html">12. mpl</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">13. Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="Extending.html">14. Extending/Contributing/Fortran</a></li>
<li class="toctree-l1"><a class="reference internal" href="tips.html">15. Tips</a></li>
<li class="toctree-l1"><a class="reference internal" href="Remarks.html">16. Intention and Remarks</a></li>
<li class="toctree-l1"><a class="reference internal" href="Installation.html">17. Installation</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="formfactor.html"
                        title="previous chapter">6. formfactor (ff)</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="dynamic.html"
                        title="next chapter">8. dynamic</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/structurefactor.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="dynamic.html" title="8. dynamic"
             >next</a> |</li>
        <li class="right" >
          <a href="formfactor.html" title="6. formfactor (ff)"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">jscatter 0.7.4 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2014-18, Ralf Biehl.
      Last updated on Apr 30, 2018.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.2.
    </div>
  </body>
</html>